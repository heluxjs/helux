# [concent, ç‚¹å‡»äº†è§£æ›´å¤š](https://concentjs.github.io/concent-site/)
<p align="center">
  <a href="#">
    <img width="500" src="https://raw.githubusercontent.com/concentjs/concent-site/master/img/banner.png">
  </a>
</p>

<br/>

<!--- é¢å¤–åŒ…ä¸€ä¸ªpæ ‡ç­¾ï¼Œé˜²æ­¢æŸäº›mdè§£æå™¨è‡ªå·±åŒ…ä¸€ä¸ªpæ ‡ç­¾ï¼Œè¿›è€Œç ´åæ ·å¼ --->
<div style="display:flex; flex-wrap: wrap">

  <a href='https://www.npmjs.com/package/concent' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/package-json/v/concentjs/concent/master.svg?label=npm%20version' alt='npm version' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/issues/concentjs/concent.svg' alt='issues open' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/npm/dw/concent.svg?label=downloads' alt='downloads' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/last-commit/concentjs/concent.svg' alt='last commit' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/commit-activity/m/concentjs/concent.svg' alt='commit activity' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
    <img src='https://raw.githubusercontent.com/fantasticsoul/static/master/img/cc-svg/build.png' alt='build:passing' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/npm/l/concent.svg' alt='license:MIT' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/david/dev/concentjs/concent.svg' alt='dev dependencies' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/bundlephobia/minzip/concent/1.4.1.svg' alt='mini bundle size' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/package-json/dependency-version/concentjs/concent/co.svg' alt='co version' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/followers/fantasticsoul.svg?style=social' alt='followers' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/stars/concentjs/concent.svg?style=social' alt='concent star' height='18'>
  </a>

</div>




## concentæ˜¯ä»€ä¹ˆï¼Œï¼ˆæ³¨ï¼šä»¥ä¸‹æœ‰çš„åœ°æ–¹ç®€ç§°ä¸ºccï¼‰
concentæ˜¯ä¸€ä¸ªä¸“ä¸º`react`æä¾›çŠ¶æ€ç®¡ç†æœåŠ¡çš„æ¡†æ¶ï¼Œé‡æ–°å®šä¹‰`state`å’Œ`component`ä¹‹é—´çš„å…³ç³»ï¼ŒåŒæ—¶ä¹Ÿä¸ºä½ çš„`react`ç»„ä»¶æä¾›æ›´å¤šæœ‰è¶£ä¸”å¼ºå¤§çš„ç‰¹æ€§ï¼Œä¿æŒæ¸²æŸ“æ€§èƒ½æœ€ä¼˜åŒ–ï¼Œè®©ä½ ä¸“æ³¨äºä¸šåŠ¡ä»£ç ç¼–å†™ğŸ˜ï¼Œè®©ä½ çš„`react`å·¥ç¨‹ä»£ç å˜å¾—æ›´åŠ ç®€çº¦ã€ä¼˜é›…ï¼Œå¹¶å®¹æ˜“ç»´æŠ¤ä¸æ‰©å±•ã€‚

## âœ¨concentçš„ç‰¹ç‚¹
* æ ¸å¿ƒapiå°‘ä¸”ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä¸Šæ‰‹å®¹æ˜“ï¼Œå…¥ä¾µå°ï¼Œå®¹æ˜“è°ƒè¯•ï¼›
* æä¾›å…¨å±€æ¨¡å—åŒ–çš„å•ä¸€æ•°æ®æºï¼›
* å…±äº«æ•°æ®å¯ç›´æ¥æ³¨å…¥åˆ°stateï¼Œä¹Ÿå¯æ³¨å…¥propsï¼Œ[ç‚¹æˆ‘æŸ¥çœ‹](https://stackblitz.com/edit/concent-state-inject-way?file=index.js)ã€‚
* ä¿®æ”¹å…±äº«æ•°æ®çš„æ–¹å¼çµæ´»å¤šæ ·ä¸”ç®€å•ç›´æ¥ï¼Œ[ç‚¹æˆ‘æŸ¥çœ‹](https://stackblitz.com/edit/concent-state-modify-way)ï¼›
* å¯¹ç»„ä»¶æ‰©å±•äº†äº‹ä»¶æ€»çº¿ã€computedã€watchã€åŒå‘ç»‘å®šç­‰ç‰¹æ€§ï¼Œ[ç‚¹æˆ‘æŸ¥çœ‹](https://stackblitz.com/edit/concent-vue-like-programming)ï¼›
* å†…ç½®ä¸react16ä¸€æ ·çš„ä½¿ç”¨æ–¹å¼ä½†å´æ›´æœ‰è¶£çš„hookï¼Œ[ç‚¹æˆ‘æŸ¥çœ‹](https://stackblitz.com/edit/concent-hook?file=index.js)ï¼›
* é»˜è®¤é‡‡ç”¨åå‘ç»§æ‰¿åŒ…è£¹ä½ çš„ç»„ä»¶ï¼Œè®©react dom treeå±‚çº§æ›´å°‘ï¼Œä¿æŒå¹²å‡€å’Œæ¸…çˆ½ï¼›
* åŸºäºå¼•ç”¨å®šä½å’ŒçŠ¶æ€å¹¿æ’­ï¼Œæ”¯æŒç»†ç²’åº¦çš„çŠ¶æ€è®¢é˜…ï¼Œæ¸²æŸ“æ•ˆç‡å‡ºä¼—ï¼Œ[ç‚¹æˆ‘æŸ¥çœ‹](https://stackblitz.com/edit/concent-why-it-is-high-performance?file=index.js)ï¼›
* æ”¯æŒä¸­é—´ä»¶ï¼Œå¯ä»¥æ‰©å±•ä½ çš„ä¸ªæ€§åŒ–æ’ä»¶å¤„ç†æ•°æ®å˜æ›´ï¼Œ[ç‚¹æˆ‘æŸ¥çœ‹](https://stackblitz.com/edit/concent-middleware?file=index.js)ï¼›
* æ”¯æŒreact 0.10+ä»»æ„ç‰ˆæœ¬ï¼›

## æ­é…react-routerä½¿ç”¨
è¯·ç§»æ­¥é˜…è¯»å’Œäº†è§£[react-router-concent](https://github.com/concentjs/react-router-concent)ï¼Œæ­é…ä½¿ç”¨éå¸¸çš„ç®€å•å’Œå®¹æ˜“ã€‚

___
## ğŸ“¦ å¿«é€Ÿå¼€å§‹
ç¡®ä¿ä½ æœ¬åœ°æœºå™¨ä¸Šå®‰è£…æœ‰[nodejs](http://nodejs.cn/download/)ã€‚
### åˆ›å»ºä¸€ä¸ªapp
åœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ç›®å½•å¹¶è¿›å…¥ï¼Œä½¿ç”¨[create-react-app](https://github.com/facebookincubator/create-react-app) åˆ›å»ºä¸€ä¸ªapp
```sh
$ npm i -g create-react-app
$ create-react-app cc-app
```
### å®‰è£…cc
åˆ›å»ºå¥½appåï¼Œè¿›å…¥ä½ çš„appæ ¹ç›®å½•ï¼Œä½¿ç”¨npmå®‰è£…`concent`
```sh
$ cd cc-app
$ npm i --save concent
```
æˆ–è€…ä½¿ç”¨yarnå®‰è£…
```sh
$ yarn add concent
```

### æ–°æ‰‹counterç¤ºä¾‹
å°†ä»¥ä¸‹ä»£ç å¤åˆ¶ç²˜è´´åˆ°`cc-app`ç›®å½•ä¸‹çš„`src/App.js`æ–‡ä»¶é‡Œ(æ³¨ï¼šæ˜¯å®Œå…¨è¦†ç›–æ‰åŸæ¥çš„å†…å®¹)ã€‚
- è¿è¡Œconcentï¼Œè½½å…¥æ¨¡å—é…ç½®
```javascript
import React, { Component, Fragment } from 'react';
import { register, run } from 'concent';

run({
  counter: {//å®šä¹‰counteræ¨¡å—
    state: {//å®šä¹‰state
      count: 0,
    },
    reducer: {
      inc(payload, moduleState) {
        return { count: moduleState.count + 1 };
      },
      dec(payload, moduleState) {
        return { count: moduleState.count - 1 };
      }
    }
  }
})
```
- åŸºäºreact classæ³¨å†Œæˆä¸ºccç±»ç»„ä»¶
```
class Counter extends Component {
  //setState èƒ½å¤Ÿå°†æ•°æ®å°†åŒæ­¥åˆ°storeï¼Œå¹¿æ’­åˆ°å…¶ä»–å®ä¾‹
  inc = () => {
    this.setState({ count: this.state.count + 1 });
  }
  dec = () => {
    this.setState({ count: this.state.count - 1 });
  }
  //è°ƒç”¨dispatch, åŒæ ·çš„èƒ½å¤Ÿå°†æ•°æ®å°†åŒæ­¥åˆ°storeï¼Œå¹¿æ’­åˆ°å…¶ä»–å±äºcounteræ¨¡å—æˆ–è€…è¿æ¥åˆ°counteræ¨¡å—çš„å®ä¾‹
  incD = () => {
    this.ctx.dispatch('inc');
  }
  decD = () => {
    this.ctx.dispatch('dec');
  }
  render() {
    //concentæ³¨å…¥counteræ¨¡å—çš„æ•°æ®åˆ°state
    const { count } = this.state;
    return (
      <div style={{ padding: '12px', margin: '6px' }}>
        <div>count: {count}</div>
        <button onClick={this.inc}>inc by setState</button>
        <button onClick={this.dec}>dec by setState</button>
        <br />
        <button onClick={this.incD}>inc by dispatch</button>
        <button onClick={this.decD}>dec by dispatch</button>
      </div>
    );
  }
}
//å°†Counterç±»æ³¨å†Œä¸ºCcClazzCounterï¼Œå±äºcounteræ¨¡å—
const CcClazzCounter = register('counter')(Counter);
```
- åŸºäºrenderPropsæ³¨å†Œä¸ºccç±»ç»„ä»¶
```
import { registerDumb } from 'concent';

const UI = ({count, inc, dec, incD, decD})=>{
    return (
      <div style={{ padding: '12px', margin: '6px' }}>
        <div>count: {count}</div>
        <button onClick={inc}>inc by setState</button>
        <button onClick={dec}>dec by setState</button>
        <br />
        <button onClick={incD}>inc by dispatch</button>
        <button onClick={decD}>dec by dispatch</button>
      </div>
    );
}

//å®šä¹‰setupï¼Œè¯¥å‡½æ•°åªä¼šåœ¨uiåˆæ¬¡æ¸²æŸ“å‰æ‰§è¡Œä¸€æ¬¡ï¼Œé€šå¸¸ç”¨äºå®šä¹‰ä¸€äº›æ–¹æ³•ï¼Œç»“æœä¼šæ”¶é›†åˆ°ctx.settingsé‡Œ
const setup = ctx=>{
  const inc = () => {
    ctx.setState({ count: ctx.state.count + 1 });
  };
  const dec = () => {
    ctx.setState({ count: ctx.state.count - 1 });
  };
  const incD = () => {
    ctx.dispatch('inc');
  };
  const decD = () => {
    ctx.dispatch('dec');
  };
  return {inc, dec, incD, decD};
}

//å®šä¹‰mapPropsï¼Œè¯¥å‡½æ•°åœ¨uiæ¯æ¬¡æ¸²æŸ“å‰è¢«æ‰§è¡Œï¼Œç»“æœå°†æ˜ å°„åˆ°ç»„ä»¶çš„propsä¸Š
const mapProps = ctx=>{
  return {count:ctx.state.count, ...ctx.settings};
}

/å°†Counterç±»æ³¨å†Œä¸ºCcFnCounterï¼Œå±äºcounteræ¨¡å—
const CcFnCounter = registerDumb({module:'counter', setup, mapProps})(UI);
```
--- åŸºäºhookæ³¨å†Œä¸ºç»„ä»¶
```
import { useConcent } from 'concent';

function HookCounter(){
  const {state, setState, dispatch} = useConcent('counter');
  const inc = () => {
    setState({ count: ctx.state.count + 1 });
  };
  const dec = () => {
    setState({ count: ctx.state.count - 1 });
  };
  const incD = () => {
    dispatch('inc');
  };
  const decD = () => {
    dispatch('dec');
  };
   return (
      <div style={{ padding: '12px', margin: '6px' }}>
        <div>count: {count}</div>
        <button onClick={inc}>inc by setState</button>
        <button onClick={dec}>dec by setState</button>
        <br />
        <button onClick={incD}>inc by dispatch</button>
        <button onClick={decD}>dec by dispatch</button>
      </div>
   );
}

```
--- æ›´ä¼˜çš„hookå†™æ³•ï¼Œå°†å‡½æ•°æå‡ä¸ºé™æ€api
```
import { useConcent } from 'concent';

const setup = ctx =>{
  const {state, setState, dispatch} = ctx;
  const inc = () => {
    setState({ count: ctx.state.count + 1 });
  };
  const dec = () => {
    setState({ count: ctx.state.count - 1 });
  };
  const incD = () => {
    dispatch('inc');
  };
  const decD = () => {
    dispatch('dec');
  };
  return {inc, dec, incD, decD};
}

function HookCounter(){
  const {settings, state} = useConcent({module:'counter', setup});
  const {inc, dec, incD, decD} = settings;

   return (
      <div style={{ padding: '12px', margin: '6px' }}>
        <div>count: {state.count}</div>
        <button onClick={inc}>inc by setState</button>
        <button onClick={dec}>dec by setState</button>
        <br />
        <button onClick={incD}>inc by dispatch</button>
        <button onClick={decD}>dec by dispatch</button>
      </div>
   );
}

```

### [0å…¥ä¾µï¼Œæ¸è¿›å¼å®ä¾‹](https://stackblitz.com/edit/cc-multi-ways-to-wirte-code?file=index.js)

___
## ğŸ”¨æ›´å¤šç²¾å½©ç¤ºä¾‹
### [stackblitzåœ¨çº¿ç»ƒä¹ ç¤ºä¾‹é›†åˆ](https://stackblitz.com/@fantasticsoul)
### [ccç‰ˆæœ¬çš„ant-design-pro](https://github.com/fantasticsoul/rcc-antd-pro)
### [ä¸€ä¸ªç›¸å¯¹å®Œæ•´çš„ç¤ºä¾‹](https://stackblitz.com/edit/cc-awesome)
### [æœ‰è¶£çš„counter](https://stackblitz.com/edit/funny-counter)
### [å¢å¼ºçš„counter](https://stackblitz.com/edit/dva-example-count-1saxx8)
### [Jsrun playground](http://jsrun.net/fLXKp/play) 
### [Jsrun video](http://jsrun.net/vLXKp/play)
### [ç¤ºä¾‹é›†åˆ](https://github.com/fantasticsoul/rcc-simple-demo)
___
## å›¾æ–‡ä»‹ç»
### ccæ¸²æŸ“æµç¨‹
![](https://raw.githubusercontent.com/concentjs/concent-site/master/img/cc-core.png)
### ccç»„ä»¶å·¥ä½œæµç¨‹
![](https://raw.githubusercontent.com/concentjs/concent-site/master/img/cc-process.png)

### [concentæ˜¯ä»€ä¹ˆ](https://concentjs.github.io/concent-site/docs/doc-intro-what-is-concent)
### [åœ¨ccé‡Œç”¨classå’Œfunctionå®ç°counter](https://juejin.im/post/5c8f77bdf265da60ec2812f7)
### [èŠä¸€èŠccçš„å˜åŒ–ä¾¦æµ‹å’Œhookå®ç°](https://juejin.im/post/5c8d99f4e51d4555816d6335)
### [åœ¨ccé‡Œç©è½¬æ— çŠ¶æ€ç»„ä»¶](https://juejin.im/post/5c838107f265da2dca389593)
### [å¯¹è¯ redux(å®¶æ—)ï¼Œåç”Ÿä½•ä»¥æŒ‘æˆ˜å‰è¾ˆï¼Ÿ](https://juejin.im/post/5c8479316fb9a049ba42635c)
### [ä¸ºä»€ä¹ˆä¸ç”¨redux](https://www.zhihu.com/question/263928256/answer/274963347)
