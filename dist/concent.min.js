!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],t):t(e.concent={},e.React,e.ReactDOM)}(this,function(e,R,n){"use strict";R=R&&R.hasOwnProperty("default")?R.default:R,n=n&&n.hasOwnProperty("default")?n.default:n;var t,r,$={},te="$$global",H="$$default",q="$$cc",V="$$concent_void_module_624313307",o="$$CONCENT_ROUTER",T="$$CcClass",U="$$CcFrag",re="$$CcHook",h="$$Cc",B="$$Dispatcher",a="__cc_dispatcher_container_designed_by_zzk_qq_is_624313307__",ne=Symbol("__for_sync_param_ccsync__"),b=Symbol("__for_mock_event__"),i=Symbol("__lazy_handle_state__"),I=10,x=11,D=13,k="dispatch",oe="setState",ae="setModuleState",ie="forceUpdate",N="invoke",g="sync",_="module",ce="ref",M="watch",ue={CC_MODULE_NAME_DUPLICATE:1002,CC_MODULE_NOT_FOUND:1012,CC_DISPATCH_STRING_INVALID:1013,CC_DISPATCH_PARAM_INVALID:1014,CC_MODULE_NOT_CONNECTED:1015,CC_CLASS_KEY_DUPLICATE:1100,CC_CLASS_INSTANCE_KEY_DUPLICATE:1200,CC_CLASS_INSTANCE_MORE_THAN_ONE:1205,CC_STORED_KEYS_NEED_CCKEY:1207,CC_REDUCER_NOT_A_FUNCTION:1503},c=((t={})[ue.CC_MODULE_NAME_DUPLICATE]="module name duplicate!",t[ue.CC_MODULE_NOT_FOUND]="module not found!",t[ue.CC_DISPATCH_STRING_INVALID]="when type param is string, it must be one of these format: (fnName)、(moduleName)/(fnName)",t[ue.CC_DISPATCH_PARAM_INVALID]="dispatch param type is invalid, it must be string or object",t[ue.CC_MODULE_NOT_CONNECTED]="module not been connected by ref",t[ue.CC_CLASS_INSTANCE_KEY_DUPLICATE]="props.ccKey duplicate",t[ue.CC_CLASS_INSTANCE_MORE_THAN_ONE]="ccClass is declared as singleton, trying new another one instance is not allowed! ",t[ue.CC_STORED_KEYS_NEED_CCKEY]="you must explicitly specify a ccKey for ccInstance when set storedKeys!",t[ue.CC_CLASS_KEY_DUPLICATE]="ccClassKey duplicate!",t[ue.CC_REDUCER_NOT_A_FUNCTION]="reducer must be a function!",t),u=Object.freeze({MODULE_GLOBAL:te,MODULE_DEFAULT:H,MODULE_CC:q,MODULE_VOID:V,MODULE_CC_ROUTER:o,CC_CLASS:T,CC_FRAGMENT:U,CC_HOOK:re,CC_PREFIX:h,CC_DISPATCHER:B,CC_DISPATCHER_BOX:a,CCSYNC_KEY:ne,MOCKE_KEY:b,LAZY_KEY:i,SIG_FN_START:I,SIG_FN_END:x,SIG_FN_QUIT:12,SIG_FN_ERR:D,SIG_MODULE_CONFIGURED:14,SIG_STATE_CHANGED:15,RENDER_NO_OP:1,RENDER_BY_KEY:2,RENDER_BY_STATE:3,FOR_ONE_INS_FIRSTLY:1,FOR_ALL_INS_OF_A_MOD:2,EFFECT_AVAILABLE:1,EFFECT_STOPPED:0,DISPATCH:k,SET_STATE:oe,SET_MODULE_STATE:ae,FORCE_UPDATE:ie,INVOKE:N,SYNC:g,CATE_MODULE:_,CATE_REF:ce,FN_CU:"computed",FN_WATCH:M,ERR:ue,ERR_MESSAGE:c,default:{MODULE_GLOBAL:te,MODULE_DEFAULT:H,MODULE_CC:q,ERR:ue,ERR_MESSAGE:c,FOR_ONE_INS_FIRSTLY:1,FOR_ALL_INS_OF_A_MOD:2}}),s=((r={})[te]={},r[H]={},r[q]={},r),d={},l={},F={_computedValue:s,_computedRaw:l,_computedDep:d,getRootComputedValue:function(){return s},getRootComputedDep:function(){return d},getRootComputedRaw:function(){return l}},f={},p={},C={_watchRaw:p,_watchDep:f,getRootWatchDep:function(){return f},getRootWatchRaw:function(){return p}},y={alwaysGiveState:!0,isStrict:!1,isDebug:!1,computedCompare:!0,watchCompare:!0,watchImmediate:!1,bindCtxToMethod:!1},se="is not a plain json object!",K="should be an string array or *!",v=console.error;function m(e){return null!=e&&0<J(e).length}function S(e){return!m(e)}function de(e,t){if(void 0===t&&(t=!1),!e)return!1;var r="object"==typeof e;if(r){var n=Array.isArray(e);return t?n:r&&!n}return!1}function E(e,t){var r="";r="string"==typeof e?e:c[e]||"",t&&(r+=t),r||(r="undefined message for code:"+e);var n=Error(r);return n.code=e,n}function w(e,t){return e+"$"+t}function O(e){return e?" --verbose-info: "+e:""}function A(e){return void 0===e&&(e="green"),"color:"+e+";border:1px solid "+e}function L(e){return"%c"+e}var j=function(e){return"------------ CC "+e+" ------------"};function P(e){v(j("WARNING")),e instanceof Error?(v(e.message),v(e.stack)):v(e)}function z(e){console.log(j("TIP")),console.log("%c"+e,"color:green;border:1px solid green;")}function G(e){if(v(j("WARNING")),v(e),y.isStrict)throw e}function W(e,t,r){void 0===r&&(r={});var n=e[t];return n||(n=e[t]=r),n}function le(e,t){var r=e[t];return r||(r=e[t]=[]),r}function Y(e){void 0===e&&(e=52);var t=Math.random();return parseInt(t*e)}function X(t,r,n){void 0===r&&(r=[]),Array.isArray(t)?t.length=0:Object.keys(t).forEach(function(e){r.includes(e)||(n?t[e]=n:delete t[e])})}function J(e){return Object.keys(e)}function Z(e){var t=null;return e&&(e.currentTarget&&e.type?t=e:e.nativeEvent&&e.target&&(e.currentTarget=e.target,t=e)),t}function Q(t,r,e){function n(e){e?e[t]=r:window[t]=r}window?n(e):setTimeout(function(){n(e)},3e3)}function ee(e,t){for(var r in e)if(!(r in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1}function fe(e,t){var r=[];return e.forEach(function(e){t.includes(e)||r.push(e)}),r}function pe(e){return void 0===e&&(e={}),"string"==typeof e?{module:e}:Object.assign({module:H},e)}var ye="";function ve(){return ye}function me(){var t=null;return{commit:function(e){t||(t={}),Object.assign(t,e)},getFnCommittedState:function(){return t}}}function he(){var e=!1;return!window||("previewFrame"===window.name||window.__SANDBOX_DATA__||window.BrowserFS)&&(e=!0),e}function _e(e){return{payload:null,renderKey:"",delay:-1,module:e,fnName:""}}function Ce(e){void 0===e&&(e={});var t="function"==typeof e?e():e;if(!de(t))throw Error("state "+se);return t}var ge={module:{computed:{},watch:{}},ref:{computed:{},watch:{},effect:{}}};function Ke(e,t,r){var n=t[e];return{retKey:e,fn:n.fn,depKeys:n.depKeys,isLazy:r}}function Se(e,t,r,n,o,a,i,c){var u=n[o],s=[];if(!u)return{pickedFns:s,setted:[],changed:[]};var d=u.retKey_fn_,l=u.retKey_lazy_,f=u.stateKey_retKeys_,p=u.fnCount;if(e){var y=J(d),v=J(i),m=v;return"computed"===r?{pickedFns:y.map(function(e){return Ke(e,d,l[e])}),setted:v,changed:m}:(y.forEach(function(e){var t=d[e];t.immediate&&s.push({retKey:e,fn:t.fn,depKeys:t.depKeys})}),{pickedFns:s,setted:v,changed:m})}var h=function(r,n){var o=[],a=[];return J(n).forEach(function(e){var t=n[e];void 0!==t&&(a.push(e),t!==r[e]&&o.push(e))}),{changed:o,setted:a}}(a,i),_=h.setted,C=h.changed;if(0===_.length)return{pickedFns:s,setted:[],changed:[]};var g=_.join(",")+"|"+C.join(",")+"|"+o,K=ge[t][r],S=c?W(K,c):K,E=S[g];return E?{pickedFns:E.map(function(e){return Ke(e,d,l[e])}),setted:_,changed:C}:(function(u,o,s,d,a,l,f){if(0===o.length)return;var e=a["*"];if(e){var i=0<s.length;e.forEach(function(e){var t=d[e],r=t.fn,n=t.compare,o=t.depKeys,a={retKey:e,fn:r,depKeys:o,isLazy:l[e]};n?i&&u.push(a):u.push(a)})}u.length<f&&function(){var c={},e=o.length,t=function(e){var i=o[e],t=a[i];return t?(t.forEach(function(e){if(!c[e]){var t=d[e],r=t.fn,n=t.compare,o=t.depKeys,a=!0;n&&!s.includes(i)&&(a=!1),a&&(c[e]=!0,u.push({retKey:e,fn:r,depKeys:o,isLazy:l[e]}))}}),u.length===f?"break":void 0):"continue"};e:for(var r=0;r<e;r++){var n=t(r);switch(n){case"continue":continue;case"break":break e}}}()}(s,_,C,d,f,l,p),S[g]=s.map(function(e){return e.retKey}),{pickedFns:s,setted:_,changed:C})}function Ee(e,t,r){var n=t[r];return void 0!==n&&(e[r]=n,!0)}function we(t,r,e,n){void 0===r&&(r=[]),void 0===e&&(e=!1),void 0===n&&(n=!1);var o={},a=[];if(!de(t))return{partialState:e?null:o,isStateEmpty:!0,ignoredStateKeys:a};var i=!0,c=J(t);return c.length<r.length?c.forEach(function(e){r.includes(e)?Ee(o,t,e)&&(i=!1):n&&a.push(e)}):(r.forEach(function(e){Ee(o,t,e)&&(i=!1)}),n&&(a=fe(c,r))),i&&e&&(o=null),{partialState:o,isStateEmpty:i,ignoredStateKeys:a}}var be=Symbol("clear");function Ne(e,t,r,n){if(y.alwaysGiveState)return[r,n];var o=t[0];return 1===t.length&&"*"!==o&&o===e?[r[o],n[o]]:[r,n]}function Oe(e,t,r,n,o,a){var i=Ne(e,t,n,o);return r(i[0],i[1],a)}for(var Ie,Ue=function(K,S,E,w,b,e,N,O,I,U,x,D,A){for(var R=0,T=e,k=!0,t=function(){var e=b(T,1===++R&&U),t=e.pickedFns,d=e.setted,l=e.changed;if(!t.length)return"break";var r=me(),f=r.commit,n=r.getFnCommittedState,o=me(),p=o.commit,a=o.getFnCommittedState;if(t.forEach(function(e){var t=e.retKey,r=e.fn,n=e.depKeys,o={retKey:t,callInfo:I,isFirstCall:U,commit:f,commitCu:p,setted:d,changed:l,stateModule:S,refModule:E,oldState:w,committedState:T,refCtx:K};if("computed"===x)if(e.isLazy){var a=A[t];delete o.commit,delete o.commitCu;var i=Ne(t,n,N,w),c=i[0],u=i[1];a?a(be,c,u,o):A[t]=function(e,t,r,n){var a=!0,i=null,c=e,u=t,s=r,d=n;return function(e,t,r,n){if(e===be)return u=t,s=r,d=n,void(a=!0);if(a){var o=c(u,s,d);i=o,a=!1}return i}}(r,c,u,o)}else{var s=Oe(t,n,r,N,w,o);A[t]=s}else!1===Oe(t,n,r,N,w,o)&&(k=!1)}),T=n()){var i=function(e,t){void 0===t&&(t=!1),T=e,t&&0===J(e).length?T=null:(Object.assign(N,T),Object.assign(O,T))},c=we(T,"ref"===D?K.privStateKeys:$[S],!0,!0),u=c.partialState,s=c.ignoredStateKeys;if(u)if(x===M){var y=(D===ce?K.computedDep[K.module]||{}:F._computedDep[S]||{}).stateKey_retKeys_;if(y){var v=[],m={};J(u).forEach(function(e){y[e]?v.push(e):m[e]=u[e]}),0<v.length&&P("these state keys["+v.join(",")+"] will been ignored, cause they are also appeared in computed depKeys,\n              cc suggest you move the logic to computed file."),i(m,!0)}else i(u)}else i(u);if(s.length){var h="they are not "+(D===ce?"private":"module")+", fn is "+D+" "+x;P("these state keys["+s.join(",")+"] are invalid, "+h)}}var _=a();if(_){var C;if("ref"===D)C="computed"===x?K.computedRetKeyFns:K.watchRetKeyFns;else{var g=F.getRootComputedDep()[S]||{};C=g.retKey_fn_||null}C&&J(_).forEach(function(e){C[e]?A[e]=_[e]:P("fnCtx.commitCu commit an invalid retKey["+e+"] for moduleComputed")})}if(10<R)throw Error("fnCtx.commit may goes endless loop, please check your code")};T;){if("break"===t())break}return k},xe=F._computedValue,De=J,Ae={},Re=function(r,e,t){var n=void 0===t?{}:t,o=n.refCtx,a=void 0===o?null:o,i=n.callInfo,c=void 0===i?{}:i,u=Te(r),s=ke(r),d=xe[r],l=F.getRootComputedDep(),f=C.getRootWatchDep(),p=a?a.module:null,y=Object.assign({},u,e),v=Object.assign({},e),m=v;return Ue(a,r,p,u,function(e,t){return Se(t,_,"computed",l,r,u,e)},m,y,v,c,!1,"computed",_,d),Ue(a,r,p,u,function(e,t){return Se(t,_,"watch",f,r,u,e)},m,y,v,c,!1,"watch",_,d),De(v).forEach(function(e){s[e]=u[e],$e(r,e),u[e]=v[e]}),v},Te=function(e){return Fe[e]},ke=function(e){return Le[e]},$e=function(e,t){je[e][t]++},Me=function(){var e;return(e={})[q]={},e[V]={},e[te]={},e[H]={},e},Fe=Me(),Le=Me(),je={},Pe={getDispatcher:function(){return Ae[B]},isHotReloadMode:function(){return!!Pe.isHot||window&&(window.webpackHotUpdate||he())},runtimeVar:y,isHot:!1,reComputed:!0,isStartup:!1,moduleSingleClass:{},moduleName_stateFn_:{},moduleName_ccClassKeys_:{},moduleName_stateKeys_:$,moduleName_isConfigured_:{},connectedModuleName_ccClassKeys_:{},ccClassKey_ccClassContext_:{},globalStateKeys:[],store:{appendState:function(e,t){var r=le($,e);J(t).forEach(function(e){r.includes(e)||r.push(e)}),Pe.store.setState(e,t)},_state:Fe,_prevState:Le,_stateVer:je,getState:function(e){return e?Te(e):Fe},getPrevState:function(e){return e?ke(e):Le},getStateVer:function(e){return e?je[e]:je},setState:function(e,t,r){return Re(e,t,r)},setGlobalState:function(e){return Re(te,e)},getGlobalState:function(){return Fe[te]}},reducer:{_reducer:(Ie={},Ie[te]={},Ie[q]={},Ie),_caller:{},_fnName_fullFnNames_:{},_module_fnNames_:{}},computed:F,watch:C,refStore:{_state:{},setState:function(e,t){var r=Pe.refStore._state,n=Object.assign({},r[e],t);r[e]=n}},init:{_init:{}},ccUkey_ref_:Ae,event_handlers_:{},ccUKey_handlerKeys_:{},handlerKey_handler_:{},renderKey_ccUkeys_:{},refs:Ae,info:{packageLoadTime:Date.now(),firstStartupTime:"",latestStartupTime:"",version:"1.5.173",author:"fantasticsoul",emails:["624313307@qq.com","zhongzhengkai@gmail.com"],tag:"destiny"},fragmentNameCount:0,featureStr_classKey_:{},userClassKey_featureStr_:{},errorHandler:null,middlewares:[],plugins:[]},ze=localStorage.length,He=Pe.refStore._state,qe=0;qe<ze;qe++){var Ve=localStorage.key(qe);if(Ve.startsWith("CCSS_"))try{He[Ve.substr(5)]=JSON.parse(localStorage.getItem(Ve))}catch(e){console.error(e)}}var Be=[],Ge=function(e){return e.toLowerCase()===q},We=function(e){return/^[\$\#\&a-zA-Z0-9_-]+$/.test(e)},Ye=O,Xe=E;function Je(e){if(!We(e))throw Error("module["+e+"] writing is invalid!");if(Ge(e))throw Error("'$$cc' is a built-in module name for concent")}function Ze(e,t,r){void 0===t&&(t=!0),void 0===r&&(r="");var n=r||"module["+e+"]",o=Pe.store._state;if(Je(e),e!==te)if(t){if(m(o[e]))throw Xe(ue.CC_MODULE_NAME_DUPLICATE,Ye(n))}else if(!o[e])throw Xe(ue.CC_MODULE_NOT_FOUND,Ye(n))}function Qe(t,e){var r=Array.isArray(e);if(!r&&"*"!==e)throw Error("storedKeys type err, "+K);r&&e.forEach(function(e){if(t.includes(e))throw Error("the item["+e+"] of storedKeys is not a module state key!")})}var et={},tt=function(e,t,r){if(e.code!==ue.CC_MODULE_NAME_DUPLICATE||!Pe.isHotReloadMode())throw e;var n=function(e){e||(e="");for(var t=e.split("\n"),r=t.length,o="",a=0;a<r;a++)if(t[a].includes(".checkModuleNameAndState")){!function(){var e=t[a+3].split(":"),r=e.length-1,n=[];e.forEach(function(e,t){t!==r&&n.push(e)}),o=n.join(":")}();break}return o}(e.stack),o=r+"|--link--|"+t,a=et[o];if(a){if(n!==a)throw e}else et[o]=n};function rt(t,e,r){void 0===r&&(r=!0);var n=t===V?{}:e;try{!function(e,t,r){if(Ze(e,r),!de(t))throw Error("module["+e+"]'s state "+se)}(t,n,r)}catch(e){tt(e,t,"state")}var o=Pe.store,a=o.getState(),i=o.getStateVer();o.getPrevState()[t]=Object.assign({},a[t]=n),i[t]=J(n).reduce(function(e,t){return e[t]=1,e},{});var c=Object.keys(n);if(Pe.moduleName_stateKeys_[t]=c,t===te){var u=Pe.globalStateKeys;c.forEach(function(e){u.includes(e)||u.push(e)})}}function nt(e,t){void 0===t&&(t=!1);var r=Pe.ccUkey_ref_,n=Pe.moduleName_ccClassKeys_,o=Pe.ccClassKey_ccClassContext_,a=[];if(e){if(!Pe.store._state[e])throw Error("module["+e+"] is not declared in store");var i=n[e];if(i&&0!==i.length){var c=i[0],u=o[c];if(!u)throw Error("no ccClassContext found for ccClassKey "+c+"!");a=u.ccKeys}if(e===H&&(a=a.filter(function(e){return!e.startsWith(U)})),0===a.length){if(!1!==t){throw Error("[[pickOneRef]]: no ref found for module["+e+"]!,if this message doesn't matter, you can ignore it")}a=[B]}}else a=[B];var s=r[a[0]];if(!s)throw Error("cc found no ref!");return s}var ot=w,at=P,it=function(){return Promise.resolve()};function ct(e,t,r,n,o){void 0===r&&(r="");var a=void 0===o?{}:o,i=a.ccClassKey,c=a.ccKey,u=a.throwError,s=a.refModule,d=void 0===s?"":s;if(void 0===e&&void 0===t)throw Error("params type error");var l,f="",p="";try{if(i&&c){var y=ot(i,c),v=Pe.refs[y];if(!v)return at("no ref found for ccUniqueKey:"+y+"!"),it();l=v.ctx.dispatch}else{if("string"==typeof e)if(e.includes("/")){var m=e.split("/");f=m[0],p=m[1]}else p=e;var h;if(!(h=f&&"*"!==f?nt(f):d?nt(d):nt()))return at("no ref found"),it();l=h.ctx.dispatch}if("*"!==f)return l(e,t,r,n);var _=Pe.reducer._fnName_fullFnNames_[p];if(!_)return;var C=[];return _.forEach(function(e){C.push(l(e,t,r,n))}),Promise.all(C)}catch(e){if(u)throw e;return at(e.message),it()}}function ut(e,t,r,n,o){return ct(e,t,r,n,o)}function st(a,e){void 0===e&&(e={});var t="module["+a+"] reducer";if(!de(e))throw Error(t+" "+se);Ze(a,!1,t+" is invalid");var r=Pe.reducer,n=r._reducer,o=r._caller,i=r._fnName_fullFnNames_,c=r._module_fnNames_,u=Object.assign({},e);n[a]=u;var s=W(o,a),d=le(c,a);u.setState||(u.setState=function(e){return e}),J(u).forEach(function(e){d.includes(e)||d.push(e);var n=a+"/"+e,t=le(i,e);t.includes(n)||t.push(n),s[e]=function(e,t,r){return ut(n,e,t,r)};var o=u[e];if("function"!=typeof o)throw Error("reducer key["+e+"] 's value is not a function");var r=o;o.__fnName&&(u[e]=r=function(e,t,r){return o(e,t,r)}),r.__fnName=e,r.__stateModule=a,r.__ctName=o.__ctName||o.constructor.name})}var dt=0,lt=["a","A","b","B","c","C","d","D","e","E","f","F","g","G","h","H","i","I","j","J","k","K","l","L","m","M","n","N","o","O","p","P","q","Q","r","R","s","S","t","T","u","U","v","V","w","W","x","X","y","Y","z","Z"];function ft(e){return dt++,(e||function(e){void 0===e&&(e=6);for(var t="",r=0;r<e;r++)t+=lt[Y()];return t}())+"_"+dt}var pt=Pe.moduleName_stateKeys_,yt=Pe.runtimeVar;function vt(e,t,r,n,o,a,i){var c=t.refCtx,u=t.type;if(e!==ce||c.__$$isBSe){if(r){var s,d,l,f=typeof r;if("string"==f)s=de(n)?((d={})[r]=n,d):((l={})[r]={fn:n,depKeys:o,compare:a,immediate:i},l);else if(de(r))s=r;else if("function"==f&&!de(s=r(c)))throw Error("type of "+u+" callback result must be an object");s?function(O,I,U){var e=yt.computedCompare,t=yt.watchCompare,x=yt.watchImmediate,D="computed"===I.type?e:t,A=I.module;J(U).forEach(function(i){var e=U[i],t=typeof e,r=e;if("function"==t&&(r={fn:e}),de(r)){var n=r,o=n.fn,a=n.depKeys,c=n.immediate,u=void 0===c?x:c,s=n.compare,d=void 0===s?D:s,l=n.lazy,f=ft("mark");if("*"===a){var p=_t(I,A,i),y=p.isStateKey,v=p.stateKey;if(!y)throw Error("retKey["+i+"] is not a state key of module["+A+"]");mt(O,I,f,v),ht(O,I,A,v,o,a,u,d,l)}else{if(a&&!Array.isArray(a))throw Error("depKeys must an string array or *");if(a&&0!==a.length){var m="",h=i;if(i.includes("/")){var _=i.split("/"),C=_[0],g=_[1];m=C,h=g}mt(O,I,f,h);var K={};a.forEach(function(e){var t=_t(I,A,e),r=t.isStateKey,n=t.stateKey,o=t.module;if(m&&o!==m)throw Error("including slash both in retKey["+i+"] and depKey["+e+"] founded, but their module is different");var a=le(K,o);if(!r)throw Error("depKey["+e+"] invalid, module["+o+"] doesn't include its stateKey["+n+"]");a.push(n)}),J(K).forEach(function(e){ht(O,I,e,h,o,K[e],u,d,l)})}else{var S=_t(I,A,i),E=S.isStateKey,w=S.stateKey,b=S.module,N=[];!a&&E&&(N=[w]),mt(O,I,f,w),ht(O,I,b,w,o,N,u,d,l)}}}else P("retKey["+i+"] item type error")})}(e,t,s):P(e+" "+u+" param type error")}}else P(e+" "+u+" must be been called in setup block")}function mt(e,t,r,n){if(e===ce){var o=t.refCtx,a=o.retKey_fnUid_,i=t.type,c=i+"_"+n;if(a[c])throw Error("ccUKey["+o.ccUniqueKey+"], retKey["+n+"] duplicate in ref "+i);a[c]=r}}function ht(e,t,r,n,o,a,i,c,u){var s=W(t.dep,r,{retKey_fn_:{},retKey_lazy_:{},stateKey_retKeys_:{},fnCount:0}),d=s.retKey_fn_,l=s.stateKey_retKeys_,f=s.retKey_lazy_,p={fn:o,immediate:i,compare:c,depKeys:a};d[n]?e!==ce&&(d[n]=p,f[n]=t.isLazyComputed||u):(d[n]=p,f[n]=t.isLazyComputed||u,s.fnCount++);var y=a;"*"===a&&(y=["*"]),e===ce&&(t.retKeyFns[n]=d[n]);var v=t.refCtx;v&&("computed"===t.type?v.hasComputedFn=!0:v.hasWatchFn=!0),y.forEach(function(e){var t=le(l,e);t.includes(n)||t.push(n)})}function _t(e,t,r){var n,o=t,a=r;if(r.includes("/")){var i=r.split("/"),c=i[0];c&&(o=c),a=i[1]}if(o===e.module)n=e.stateKeys;else{if(!(n=pt[o]))throw E(ue.CC_MODULE_NOT_FOUND,O("module["+o+"]"));if(!e.connect[o])throw E(ue.CC_MODULE_NOT_CONNECTED,O("module["+o+"], stateKey["+a+"]"))}return{isStateKey:n.includes(a),stateKey:a,module:o}}var Ct=W,gt=de;function Kt(r,e){if(e){var t="module["+r+"] computed";if(!gt(e))throw Error(t+" "+se);Ze(r,!1,t+" is invalid");var n=Pe.computed,o=Pe.store.getState(),a=n.getRootComputedValue(),i=n.getRootComputedDep();n.getRootComputedRaw()[r]=e;var c=o[r];vt(_,{module:r,stateKeys:J(c),dep:i},e);var u=Pe.getDispatcher(),s=Object.assign({},c),d=Ct(a,r);Ue(u&&u.ctx,r,u&&u.ctx.module,c,function(e,t){return Se(t,_,"computed",i,r,c,e)},c,c,s,_e(r),!0,"computed",_,d)}}var St=de,Et=W,wt=J;function bt(r,e,t){if(void 0===t&&(t=!1),e){var n="module["+r+"] watch";if(!St(e))throw Error(n+" "+se);Ze(r,!1,n+" is invalid");var o=Pe.watch.getRootWatchDep(),a=Pe.watch.getRootWatchRaw(),i=Pe.computed.getRootComputedValue();if(t){var c=a[r];c?Object.assign(c,e):a[r]=e}else a[r]=e;var u=(0,Pe.store.getState)(r);vt(_,{module:r,stateKeys:wt(u),dep:o},e);var s=Pe.getDispatcher(),d=Object.assign({},u),l=Et(i,r);Ue(s&&s.ctx,r,s&&s.ctx.module,u,function(e,t){return Se(t,_,"watch",o,r,u,e)},u,u,d,_e(r),!0,"watch",_,l)}}var Nt=[I,x,12,D,14,15],Ot={};function It(t,r){Ot[t].forEach(function(e){e({sig:t,payload:r})})}function Ut(e,t){function r(e,t){var r=Ot[e];r?r.push(t):console.warn("invalid sig["+e+"]")}Array.isArray(e)?e.forEach(function(e){r(e,t)}):r(e,t)}Nt.forEach(function(e){return Ot[e]=[]});var xt=function(e){if(!Pe.errorHandler)throw e;Pe.errorHandler(e)},Dt=0,At={},Rt={},Tt={},kt={};function $t(){return++Dt}function Mt(e,t,r,n){if(r){var o=n[e];o||(o=n[e]={});var a=o[t];a?Object.assign(a,r):o[t]=r}}function Ft(e,t,r){Mt(e,t,r,At)}function Lt(e,t,r){return Ft(e,t,r),function(e){var t=function(e){return At[e]}(e),r=[];return J(t).forEach(function(e){r.push({module:e,state:t[e]})}),r}(e)}function jt(e){delete At[e]}var Pt={},zt=function(e,t,r){void 0===r&&(r=1e3);var n=Pt[t];n&&clearTimeout(n),Pt[t]=setTimeout(function(){delete Pt[t],e()},r)};function Ht(e,r,n,t,o,a,i){if(void 0===i&&(i=!1),!e.hasWatchFn)return!0;var c=Object.assign({},t),u=e.watchDep,s=e.module,d=e.ccUniqueKey,l=e.refComputed,f=Object.assign({},n,t),p=Ue(e,r,s,n,function(e,t){return Se(t,"ref","watch",u,r,n,e,d)},t,f,c,o,a,"watch",ce,l);return i&&Object.assign(t,c),p}function qt(e,r,n,t,o,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1);var c=Object.assign({},t);if(!e.hasComputedFn)return c;var u=e.computedDep,s=e.module,d=e.refComputed,l=e.ccUniqueKey,f=Object.assign({},n,t);return Ue(e,r,s,n,function(e,t){return Se(t,ce,"computed",u,r,n,e,l)},t,f,c,o,a,"computed",ce,d),i&&Object.assign(t,c),c}var Vt=de,Bt=P,Gt=m,Wt=function(e,t){return e+"/"+Object.keys(t).sort().join("|")},Yt=J,Xt=fe,Jt=1,Zt=2,Qt=ie,er=oe,tr=ae,rr=N,nr=g,or=15,ar=1,ir=2,cr=3,ur=Pe.store,sr=ur.setState,dr=ur.getPrevState,lr=Pe.middlewares,fr=Pe.moduleName_ccClassKeys_,pr=Pe.ccClassKey_ccClassContext_,yr=Pe.connectedModuleName_ccClassKeys_,vr=Pe.refStore,mr=Pe.moduleName_stateKeys_,hr=Pe.ccUkey_ref_,_r=Pe.renderKey_ccUkeys_;function Cr(e,t,r){var n=void 0===t?{}:t,o=n.module,a=n.skipMiddleware,i=void 0!==a&&a,c=n.payload,u=n.reactCallback,s=n.type,d=n.calledBy,l=void 0===d?er:d,f=n.fnName,p=void 0===f?"":f,y=n.renderKey,v=void 0===y?"":y,m=n.delay,h=void 0===m?-1:m;if(void 0!==e)if(Vt(e)){var _=r.ctx,C=_.module,g=_.ccUniqueKey,K=_.ccKey,S=function(e,t){return e===t?Jt:Zt}(o,C),E={payload:c,renderKey:v,ccKey:K,module:o,fnName:p},w=function(e,t,r){var n=we(t,mr[e],!0).partialState;if(n){var o=sr(e,n,r);return Object.assign(n,o),n}return n}(o,e,{refCtx:S===Jt?r.ctx:null,callInfo:E});Object.assign(e,w),gr(r,E,v,l,e,S,u,function(e,t){e===ar&&!w||It(or,{committedState:t,sharedState:w,module:o,type:function(e,t){return[Qt,er,tr,rr,nr].includes(e)?"ccApi/"+e:"dispatch/"+t}(l,s),ccUniqueKey:g,renderKey:v}),w&&function(e,t,r,n,o,a,i){var c=function(){!function(d,e,l,t,r,n){if(!l)return;var o=e.ctx,f=o.ccUniqueKey,a=pr[o.ccClassKey].renderKeyClasses,p=t===Jt,y=fr[r]||[],v=[];if(n){y="*"===a?[]:Xt(y,a);var i=_r[n]||[],c=function(e,t){var r=e.indexOf(t);if(-1<r){var n=e.slice();return n.splice(r,1),n}return e}(i,f);(function(e,n,o,a){e.forEach(function(e){var t=hr[e],r=t.ctx.module;r===n?gr(t,a,null,"broadcastState",o,Jt):z("although ref's renderKey matched but its module "+r+" mismatch target module "+n+", cc will ignore trigger it re-render")})})(v=c,r,l,d)}for(var u=y.length,s=function(e){var t=y[e],r=pr[t],n=r.ccKeys,o=r.watchedKeys,a=r.originalWatchedKeys;if(0===n.length)return"continue";if(0===o.length)return"continue";var i=void 0;if("*"===a)i=l;else{var c=we(l,o,!0),u=c.partialState,s=c.isStateEmpty;if(s)return"continue";i=u}n.forEach(function(e){if(!(v.includes(e)||e===f&&p)){var t=hr[e];t&&gr(t,d,null,"broadcastState",i,Jt)}})},m=0;m<u;m++)s(m);!function(r,n,o){var a=Yt(n);(yr[r]||[]).forEach(function(e){var t=pr[e];!function(e,o,a,t,i){var r=e.connectedModuleKeyMapping;if(1===e.connectedModule[o]){for(var n=e.ccKeys,c=!1,u=t.length,s=0;s<u;s++){var d=o+"/"+t[s];if(r[d]){c=!0;break}}if(!0===c){var l=dr(o);n.forEach(function(e){var t=hr[e];if(t&&!0!==t.__$$isUnmounted){var r=t.ctx;qt(r,o,l,a,i);var n=Ht(r,o,l,a,i);n&&r.__$$ccForceUpdate()}})}}}(t,r,n,a,o)})}(r,l,d)}(e,t,r,n,o,a)};if(0<i){var u=Wt(t.ctx.ccUniqueKey,r);zt(c,u,i)}else c()}(E,r,w,S,o,v,h)},i,{calledBy:l,type:s,payload:c,renderKey:v,delay:h,ccKey:K,ccUniqueKey:g,committedState:e,refModule:C,module:o,fnName:p,sharedState:w})}else Bt("your committed state "+se)}function gr(e,t,r,n,o,a,i,c,u,s){var d=e.state,l=e.ctx;if(!0===e.__$$isUnmounted||a!==Jt||n!==Qt&&!Gt(o))return i&&i(d),c&&c(ar,o);var f=l.module,p=l.storedKeys,y=l.ccUniqueKey,v=cr;if(r&&(v=ir,l.renderKey!==r))return c&&c(ar,o);if(0<p.length){var m=we(o,p),h=m.partialState;if(!m.isStateEmpty){if(!0===l.persistStoredKeys){var _=we(d,p),C=Object.assign({},_.partialState,h);localStorage.setItem("CCSS_"+y,JSON.stringify(C))}vr.setState(y,h)}}function g(){return l.__$$ccSetState(K,i,S)}var K=qt(l,f,d,o,t),S=Ht(l,f,d,K,t,!1,!0);c?(s.state=K,function(e,r,n){if(!0!==e){var o=lr.length;if(0<o){var a=0;!function e(){if(a===o)n();else{var t=lr[a];a++,"function"==typeof t?t(r,e):(Bt("found one middleware is not a function"),e())}}()}else n()}else n()}(u,s,function(){g(),c(v,K)})):g()}function Kr(e,t,r,n,o){void 0===n&&(n=-1);try{nt(e).ctx.changeState(t,{ccKey:"[[top api:setState]]",module:e,renderKey:r,delay:n,skipMiddleware:o})}catch(e){G(e)}}var Sr=Pe.store.setState,Er=Pe.globalStateKeys,wr="note! you are trying set state for global module, but the state you commit include some invalid keys which is not declared in cc's global state, \ncc will ignore them, but if this result is not as you expected, please check your committed global state!";var br=P,Nr=de,Or=Pe.store,Ir=Or.getState,Ur=Or.setState,xr=Pe.reducer._reducer,Dr=Pe.computed._computedValue,Ar=E,Rr=O;function Tr(e,t){void 0===t&&(t=!0);try{return Ze(e,!1,"module["+e+"] is not configured in store"),!0}catch(e){return function(e,t){if(void 0===t&&(t=!0),t)throw e;Mr(e)}(e,t),!1}}function kr(o,a){return function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e?a(e):o.apply(void 0,r)}}function $r(e,t,r,n){var o;return!0===e?(function(e){Tt[e]=!0}(o=$t()),n[o]=1):n[o=t||$t()]||(n[o]=1),{_chainId:o,_oriChainId:r||o}}function Mr(e,t){e&&(t?t(e):(br(e),Pe.errorHandler&&Pe.errorHandler(e)))}function Fr(e,t,r){return function(n,o,a,i){return new Promise(function(e,t){var r=Object.assign(a,{__innerCb:kr(e,t)});n(o,r,i)}).catch(xt)}(Hr,e,t,r)}function Lr(e,t,r){return Fr(e,{callerRef:t.callerRef,context:!0,module:t.module,calledBy:t.calledBy,fnName:e.name,delay:t.delay,renderKey:t.renderKey,chainId:t.chainId,oriChainId:t.oriChainId,chainId_depth_:t.chainId_depth_,isSilent:t.isSilent},r)}function jr(a,i){return function(e,t,r){var n=a.ctx;if(i){var o=Object.assign({},n.state,e);i.state=o}r?(n.renderCount+=1,n.reactSetState(e,t)):(Object.assign(a.state,e),n.state=a.state)}}function Pr(r){return function(e){var t=r.ctx;t.renderCount+=1,t.reactForceUpdate(e)}}function zr(_,e){var t=void 0===e?{}:e,C=t.chainId,g=t.oriChainId,K=t.isLazy,r=t.delay,S=void 0===r?-1:r,n=t.isSilent,E=void 0!==n&&n,o=t.chainId_depth_,w=void 0===o?{}:o;return function(e,t,r,n){var o=K,a=E,i="",c=null!=n?n:S;if(Nr(r)){var u=r.lazy,s=r.silent,d=r.renderKey,l=r.delay;void 0!==u&&(o=u),void 0!==s&&(a=s),void 0!==d&&(i=d),void 0!==l&&(c=l)}else i=r;var f,p,y=$r(o,C,g,w),v=typeof e,m={callerRef:_,calledBy:N,module:_.ctx.module,isSilent:a,chainId:y._chainId,oriChainId:y._oriChainId,chainId_depth_:w,delay:c,renderKey:i},h=Error("param type error, correct usage: invoke(userFn:function, ...args:any[]) or invoke(option:[module:string, fn:function], ...args:any[])");if("function"==v)return e.__fnName&&(e.name=e.__fnName),Lr(e,m,t);if("object"!=v)throw h;if(p=Array.isArray(e)?(f=e[1],e[0]):(f=e.fn,e.module),"function"!=typeof f)throw h;return p&&(m.module=p),Lr(f,m,t)}}function Hr(f,e,p){var y=e.callerRef,v=y.ctx.module,t=e.module,m=void 0===t?v:t,r=e.context,h=void 0!==r&&r,_=e.__innerCb,C=e.type,g=e.calledBy,K=e.fnName,n=e.delay,S=void 0===n?-1:n,E=e.renderKey,w=e.chainId,b=e.oriChainId,N=e.chainId_depth_,O=e.isSilent;!function(e,t,r,n){var o=r;Tr(e,!1)?(e!==t&&r&&(br(function(e,t){return"param module["+e+"] must equal current ref's module["+t+"] when pass param reactCallback, or it will never been triggered! "}(e,t)),o=null),n(null,o)):n(Error("inputModule:"+e+" invalid"),null)}(m,v,e.cb,function(e,n){if(e)return Mr(e,_);var o,t=Ir(m),r={};if(o=w===b&&1===N[w],h){N[w]=N[w]+1;var a=qr(y,!1,O,m,E,S,w,b,N),i=qr(y,!1,!0,m,E,S,w,b,N),c=qr(y,!0,O,m,E,S,w,b,N),u=zr(y,{delay:S,chainId:w,oriChainId:b,chainId_depth_:N}),s=zr(y,{isLazy:!0,delay:S,oriChainId:b,chainId_depth_:N}),d=zr(y,{isLazy:!1,delay:S,isSilent:!0,oriChainId:b,chainId_depth_:N}),l=function(e){return kt[e]}(w)||{};r={module:m,callerModule:v,committedStateMap:l,committedState:l[m]||{},invoke:u,lazyInvoke:s,silentInvoke:d,invokeLazy:s,invokeSilent:d,dispatch:a,lazyDispatch:c,silentDispatch:i,dispatchLazy:c,dispatchSilent:i,rootState:Ir(),globalState:Ir(te),moduleState:t,moduleComputed:Dr[m]||{},setState:function(e){return a("setState",e,{silent:O,renderKey:E,delay:S})},refCtx:y.ctx}}!1===O&&It(I,{isSourceCall:o,calledBy:g,module:m,chainId:w,fn:f}),new Promise(function(e){return e(f(p,t,r))}).then(function(e){N[w]=N[w]-1;var t=1===N[w];!function(e,t,r){Mt(e,t,r,kt)}(w,m,e);var r=[];!1===O&&(It(x,{isSourceCall:o,calledBy:g,module:m,chainId:w,fn:f}),!function(e){return!0===Tt[e]}(w)?r=[{module:m,state:e}]:t?function(e){return!0===Rt[e]}(w)||(r=Lt(w,m,e),jt(w)):Ft(w,m,e)),r.forEach(function(e){e.state&&Cr(e.state,{renderKey:E,module:e.module,reactCallback:n,type:C,calledBy:g,fnName:K,delay:S,payload:p},y)}),o&&(jt(w),function(e){delete kt[e]}(w)),_&&_(null,e)}).catch(function(e){It(D,{isSourceCall:o,calledBy:g,module:m,chainId:w,fn:f}),Mr(e,_)})})}function qr(N,O,I,U,x,D,A,R,T){return void 0===x&&(x=""),void 0===D&&(D=-1),void 0===T&&(T={}),function(e,r,t,n){void 0===e&&(e={});var o=O,a=I,i="",c=n||D;if(Nr(t)){i=x;var u=t.lazy,s=t.silent,d=t.renderKey,l=t.delay;void 0!==u&&(o=u),void 0!==s&&(a=s),void 0!==d&&(i=d),void 0!==l&&(c=l)}else i=t||x;function f(){return zr(N,{chainId:m,oriChainId:h,isLazy:o,chainId_depth_:T})(e,r,i,c)}var p,y,v=$r(o,A,R,T),m=v._chainId,h=v._oriChainId,_=typeof e,C=U;if(_&&"object"==_){if(Array.isArray(_))return f();var g=e.module;g&&(C=g),p=e.type,y=e.cb}else{if("string"!=_&&"function"!=_)return Promise.reject(Ar(ue.CC_DISPATCH_PARAM_INVALID));var K=e;if("function"==_){var S=e.__fnName;if(!S)return f();K=S,1==T[h]&&(C=e.__stateModule)}var E=K.split("").filter(function(e){return"/"===e}).length;if(0===E)p=K;else{if(1!==E)return Promise.reject(Ar(ue.CC_DISPATCH_STRING_INVALID,Rr(K)));var w=K.split("/"),b=w[0];b&&(C=b),p=w[1]}}return"*"===C?ct("*/"+p,r,{silent:a,lazy:o,renderKey:i},c,{refModule:N.ctx.module}):new Promise(function(e,t){!function(e){var t=void 0===e?{}:e,r=t.callerRef,n=t.module,o=t.renderKey,a=t.isSilent,i=t.type,c=t.payload,u=t.cb,s=t.__innerCb,d=t.delay,l=void 0===d?-1:d,f=t.chainId,p=t.oriChainId,y=t.chainId_depth_,v=xr[n];if(!v)return s(Error("no reducerMap found for module:["+n+"]"));var m=v[i];if(!m)return s(Error("no reducer fn found for ["+n+"/"+i+"], is these fn you want:"+Object.keys(v)));Hr(m,{callerRef:r,module:n,type:i,cb:u,context:!0,__innerCb:s,calledBy:k,delay:l,renderKey:o,isSilent:a,chainId:f,oriChainId:p,chainId_depth_:y},c)}({callerRef:N,module:C,type:p,payload:r,cb:y,__innerCb:kr(e,t),delay:c,renderKey:i,isSilent:a,chainId:m,oriChainId:h,chainId_depth_:T})}).catch(xt)}}function Vr(o){return function(t){try{Kr(o,t)}catch(e){if(o===te)!function(e,t,r){void 0===t&&(t=""),void 0===r&&(r="");var n=we(e,Er),o=n.partialState,a=n.isStateEmpty,i=J(o),c=J(e);if(i.length<c.length){var u=c.filter(function(e){return!i.includes(e)});P(wr+",invalid keys: "+u.join(",")+", make sure the keys is invalid and their values are not undefined"),console.log(e),t&&P("module is "+t),r&&P("ccClassKey is "+r)}Sr(te,o)}(t,o);else{var r=Ir(o);if(!r)return P("invalid module "+o);var n=we(t,J(r));n.isStateEmpty||Ur(o,n.partialState)}z("no ccInstance found for module["+o+"] currently, cc will just store it, lately ccInstance will pick this state to render")}}}var Br=function(o){return function(e,t){var r=o.ctx,n=Object.assign({},o.state,e);r.type===re?(o.state=r.state=n,r.__boundSetState(n),t&&t(n)):(r.state=n,o.__$$isBF?Object.assign(o.state,e):o.state=n,r.__boundSetState(n,t))}},Gr=function(n){return function(e){var t=n.ctx;if(t.type===re){var r=Object.assign({},n.state);t.__boundSetState(r),e&&e(r)}else t.__boundForceUpdate(e)}},Wr=de,Yr=Ce;function Xr(t,e){if(Pe.isStartup){if(!Wr(e))throw Error("param config "+se);if(t===te)throw Error("configuring global module is not allowed");var r=e.reducer,n=e.computed,o=e.watch,a=e.init,i=e.isClassSingle,c=Yr(e.state);if(r&&!Wr(r))throw Error("config.reducer "+se);if(rt(t,c,!0),st(t,r),n&&Kt(t,n),o&&bt(t,o),Pe.moduleSingleClass[t]=!0===i,a){if("function"!=typeof a)throw Error("init value must be a function!");Promise.resolve().then(a).then(function(e){Vr(t)(e)})}Pe.moduleName_isConfigured_[t]=!0,It(14,t)}else Be.push({module:t,config:e})}function Jr(n,o){var a={};return J(n).forEach(function(e){function t(){return r.apply(void 0,arguments)}var r=n[e];t.__fnName=e,t.__stateModule=o,a[e]=t}),a}function Zr(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function Qr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var en=J,tn=de,rn=Pe.store._state;var nn=S,on=E,an=Pe.featureStr_classKey_,cn=Pe.userClassKey_featureStr_,un=Pe.ccClassKey_ccClassContext_,sn=0;var dn=Pe.moduleName_stateKeys_,ln=Pe.moduleName_ccClassKeys_,fn=Pe.moduleSingleClass,pn=Pe.ccClassKey_ccClassContext_,yn=Pe.connectedModuleName_ccClassKeys_,vn=Pe.computed._computedValue,mn=function(e,t){var r=!1,n=!1;if(!Array.isArray(e))return{duplicate:r,notArray:!0,keyElementNotString:n};if(!Array.isArray(t))return{duplicate:r,notArray:!0,keyElementNotString:n};var o=e.length,a=t.length;e:for(var i=0;i<o;i++){var c=e[i];if("string"!=typeof c){n=!0;break e}for(var u=0;u<a;u++){var s=t[u];if("string"!=typeof s){n=!0;break e}if(s===c){r=!0;break e}}}return{duplicate:r,notArray:!1,keyElementNotString:n}},hn=O;function _n(e,t,r,n,o,a,i,c,u){void 0===e&&(e=H),void 0===a&&(a=[]),!0===c&&function(){if(!0!==Pe.isStartup)throw Error("you must startup cc by call startup method before register ReactClass to cc!")}();var s="cc"===u;Ze(e,!1,"module["+e+"] is not configured in store"),Qe(dn[e],a);var d=i;Array.isArray(i)&&(d={},i.forEach(function(e){return d[e]="*"}));var l,f=function(e,t,r){if(!r)return[];if("*"===r)return dn[e];var n=mn(r,[]);if(n.notArray||n.keyElementNotString)throw Error("watchedKeys "+K+" "+hn("ccClassKey:"+t));return r}(e,t,o),p=function(o,e,t,a){if(!tn(o))throw Error("CcFragment or CcClass's prop connect type error, it "+se);function i(e){return c+" module["+e+"]'s value must be * or array of string"}var c="CcFragment or CcClass's prop connect is invalid,",r=en(o);r.sort();var u=[],s={};if(r.forEach(function(t){var r=rn[t],n=a+"_"+t+"/";if(void 0===r)throw Error(c+" module["+t+"] not found in cc store ");var e=o[t];if("string"==typeof e){if("*"!==e)throw Error(i(t));u.push(n+"*"),en(r).forEach(function(e){return s[t+"/"+e]=e})}else{if(!Array.isArray(e))throw Error(i(t));e.forEach(function(e){if(!r.hasOwnProperty(e))throw Error(c+" module["+t+"]'s key["+e+"] not declared in cc store ");n+=e+",",s[t+"/"+e]=e}),u.push(n)}}),u.push("|"),"*"===e)u.push(a+"_$"+t+"/*");else{e.sort();var n=t+"/"+e.join(",");u.push(n)}return{featureStr:u.join("@"),connectedModuleKeyMapping:s,connectedModuleNames:r}}(d,f),y=p.connectedModuleKeyMapping,v=p.connectedModuleNames,m=function(e,t,r,n,o,a,i){if(void 0===i&&(i=""),!i){if(t===H&&nn(r)&&0===n.length)return o+"0";var c=o+":"+a,u=an[c];return u||(an[c]=u=""+o+ ++sn)}if(i.startsWith(h))throw Error("user can not specify a classKey["+i+"] starts with $$Cc");if(!e&&i.toLowerCase()==B.toLowerCase())throw Error(B+" is cc built-in ccClassKey name, if you want to customize your dispatcher, \n      you can set autoCreateDispatcher=false in StartupOption, and use createDispatcher then.");if(un[i]){if(cn[i]!==a)throw on(ue.CC_CLASS_KEY_DUPLICATE,"ccClassKey:["+i+"] duplicate")}else cn[i]=a;return i}(s,e,d,f,n,p.featureStr,t);if(r){if(!Array.isArray(r)&&"*"!==r)throw Error("renderKeyClasses type err, it is must be an array or string *");l=r}else l=[m];return function(r,e,t,n,o,a,i){var c=pn[r];c||(c=function(e,t,r,n,o){return{module:e,ccClassKey:t,renderKeyClasses:r,originalWatchedKeys:o,watchedKeys:n,ccKeys:[],connectedState:{},connectedModuleKeyMapping:null,connectedModule:{}}}(t,r,e,o,n),pn[r]=c);var u={},s={};if(a){var d=Pe.store._state,l=c.connectedState;i.forEach(function(e){l[e]=d[e],s[e]=vn[e],u[e]=1;var t=le(yn,e);t.includes(r)||t.push(r)}),c.connectedModuleKeyMapping=a,c.connectedModule=u,c.connectedComputed=s}}(m,l,e,o,f,y,v),function(e,t){var r=le(ln,e);if(!0===fn[e]&&1<=r.length)throw Error("module["+e+"] is declared as single, only on ccClassKey can been registered to it, and now a ccClassKey["+r[0]+"] has been registered!");r.includes(t)||r.push(t)}(e,m),{_module:e,_connect:d,_watchedKeys:f,_ccClassKey:m}}var Cn=P,gn=E,Kn=O,Sn=L,En=A,wn=Pe.runtimeVar,bn=Pe.ccClassKey_ccClassContext_,Nn=Pe.ccUkey_ref_,On={};function In(e,t,r,n){function o(){Nn[e]=t,r.push(e)}!function(e){void 0===On[e]?On[e]=1:On[e]+=1}(e),n?setTimeout(o,n):o()}function Un(e,t,r,n,o){var a=bn[r],i=a.ccKeys;wn.isDebug&&console.log(Sn("register ccKey "+o+" to CC_CONTEXT"),En());var c=Pe.isHotReloadMode();if(i.includes(o)){var u=function(){throw gn(ue.CC_CLASS_INSTANCE_KEY_DUPLICATE,Kn("ccClass:"+r+",ccKey:"+o))};if(c){var s=function(e){return void 0===On[e]?0:On[e]}(o);if(t&&0<s)throw gn(ue.CC_CLASS_INSTANCE_MORE_THAN_ONE,Kn("ccClass:"+r));1<s&&u(),Cn("\n        found ccKey["+n+"] duplicated in hot reload mode, please make sure your ccKey is unique manually,\n        "+Kn("ccClassKey:"+r+" ccKey:"+n+" ccUniqueKey:"+o)+"\n      "),In(o,e,i,600)}else u()}else In(o,e,i);return a}var xn=Pe.event_handlers_,Dn=Pe.handlerKey_handler_,An=Pe.ccUKey_handlerKeys_,Rn=Pe.ccUkey_ref_,Tn=function(e,t,r){return e+"$"+t+"$"+r},kn=le,$n=P;function Mn(e,t,r,n,o){void 0===o&&(o=null);var a=xn[e];if(a){var i=a;return n?i=a.filter(function(e){return e.ccUniqueKey===n}):r?i=a.filter(function(e){return e.ccClassKey===r}):t&&(i=a.filter(function(e){return e.module===t})),void 0!==o&&(i=i.filter(function(e){return e.identity===o})),i}return[]}function Fn(e){var o={},n=[];e.forEach(function(e){var t=e.ccUniqueKey,r=e.event;delete Dn[e.handlerKey],o[t]=1,n.includes(r)||n.push(r)}),n.forEach(function(e){var n=xn[e];n&&(n.forEach(function(e,t){var r=e.ccUniqueKey;1===o[r]&&(n[t]=null,delete An[r])}),xn[e]=n.filter(function(e){return null!==e}))})}function Ln(e,t,r,n,o,a){var i=kn(xn,n);if("function"!=typeof a)return $n("event "+n+"'s handler is not a function!");var c=Tn(r,n,o),u=kn(An,r),s=i.findIndex(function(e){return e.handlerKey===c}),d={event:n,module:e,ccClassKey:t,ccUniqueKey:r,identity:o,handlerKey:c,fn:a};-1<s?i[s]=d:(i.push(d),u.push(c)),Dn[c]=d}function jn(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,a,i,c,u=null;"string"==typeof e?o=e:(o=e.name,u=e.identity,a=e.module,i=e.ccClassKey,c=e.ccUniqueKey),Mn(o,a,i,c,u).forEach(function(e){var t=e.handlerKey;if(Rn[e.ccUniqueKey]&&t){var r=Dn[t];r&&r.fn.apply(r,n)}})}function Pn(e,t){Fn(Mn(e,t.module,t.ccClassKey,t.ccUniqueKey,t.identity))}function zn(e){var t=An[e];if(t){var r=[];t.forEach(function(e){return r.push(Dn[e])}),Fn(r)}}function Hn(e){if(e&&"object"==typeof e){var t;if(Array.isArray(e))t={name:e[0],identity:e[1]};else t=Object.assign({},e);return t}return{name:e}}var qn=Object.freeze({bindEventHandlerToCcContext:Ln,findEventHandlersToPerform:jn,findEventHandlersToOff:Pn,offEventHandlersByCcUniqueKey:zn,getEventItem:Hn});function Vn(o,a){return void 0===a&&(a=!1),function(e,t,r,n){vt(ce,{type:"computed",isLazyComputed:a,refCtx:o,stateKeys:o.stateKeys,retKeyFns:o.computedRetKeyFns,module:o.module,connect:o.connect,dep:o.computedDep},e,t,r,n)}}var Bn=P,Gn=w;function Wn(e){return e?e.props||e:{}}var Yn=Pe.store.getState;function Xn(e){var t=Z(e);return t?t.currentTarget.value:e}var Jn=function(e,t,r){var n,o=r.module,a=r.state,i=!1,c="",u="",s="",d=void 0,l=-1,f=!1,p=e[ne],y=e.type,v=!1;if(void 0!==p)if(c=p,l=e.delay,u=e.rkey,"val"===y||"int"===y){i="int"===y;var m=e.val;if(void 0===m)s=Xn(t);else if("function"==typeof m){var h,_,C;if(c.includes("/")){var g=c.split("/");h=g[1],_=c,C=g[0]}else _=o+"/"+(h=c),C=o;v=!0,d=m(Xn(t),h,{moduleState:Yn(C),fullKeyPath:_,state:a,refCtx:r})}else s=m}else{if("bool"!==y)return null;f=!0}else{var K=Z(t);if(!K)return null;var S=K.currentTarget;s=S.value;var E=S.dataset;if(i="int"===y||void 0!==E.ccint,!(c=E.ccsync))return null;u=E.ccrkey;var w=E.ccdelay;if(w)try{l=parseInt(w)}catch(e){}}return(n={})[b]=1,n.currentTarget={value:s,extraState:d,hasSyncCb:v,dataset:{ccsync:c,ccint:i,ccdelay:l,ccrkey:u}},n.isToggleBool=f,n};var Zn=function(e,t,r,n,o){var a=t;!0!==r||Number.isNaN(a=parseInt(t))&&(P(t+" can not convert to int but you set ccint as true!！"),a=t);var i=null,c=[];if(e.includes("/")){var u=e.split("/"),s=u[1];i=u[0],c=s.includes(".")?s.split("."):[s]}else c=e.includes(".")?e.split("."):[e];if(1===c.length){var d,l,f=c[0];return!0!==o?{module:i,state:(d={},d[f]=a,d)}:{module:i,state:(l={},l[f]=!n[f],l)}}var p,y=c[0],v=c.slice(1),m=n[y];return function e(t,r,n,o,a,i){void 0===i&&(i=!1);var c=r[o];if(n===o)if(!0===i){var u=t[c];"boolean"!=typeof u?P("key["+c+"]'s value type is not boolean"):t[c]=!u}else t[c]=a;else e(t[c],r,n,++o,a,i)}(m,v,v.length-1,0,a,o),{module:i,state:(p={},p[y]=m,p)}},Qn=Pe.store.getState;function eo(e,t,r){var n=t.ctx,o=n.module,a=null;if(a=e[b]?e:Jn(e,r,n)){var i=a.currentTarget,c=i.dataset,u=i.value,s=i.extraState,d=i.hasSyncCb;r&&r.stopPropagation&&r.stopPropagation();var l=c.ccsync,f=c.ccint,p=c.ccdelay,y=c.ccrkey;if(l.startsWith("/")&&(c.ccsync=""+o+l),l.includes("/")){var v=l.split("/")[0];Ze(v,!1);var m=n.ccKey,h=n.ccUniqueKey;if(d)return void(s&&Cr(s,{calledBy:g,ccKey:m,ccUniqueKey:h,module:v,renderKey:y,delay:p},t));var _=v!==o?Qn(v):t.state;Cr(Zn(l,u,f,_,a.isToggleBool).state,{calledBy:g,ccKey:m,ccUniqueKey:h,module:v,renderKey:y,delay:p},t)}else{if(d)return void(s&&t.setState(s,null,y,p));var C=Zn(l,u,f,t.state,a.isToggleBool);t.setState(C.state,null,y,p)}}}var to=Pe.refStore,ro=Pe.ccClassKey_ccClassContext_,no=Pe.moduleName_stateKeys_,oo=Pe.store.getState,ao=Pe.moduleName_ccClassKeys_,io=Pe.computed._computedValue,co=Pe.renderKey_ccUkeys_,uo=J,so=E,lo=O,fo=le,po=P,yo=0;var vo=function(){},mo=function(e){return"type of defineEffect "+e+" param must be"};function ho(a,e,t){var r;void 0===t&&(t=5);var n=e.isSingle,c=e.ccClassKey,o=e.ccKey,i=void 0===o?"":o,u=e.module,s=e.type,d=e.state,l=e.storedKeys,f=void 0===l?[]:l,p=e.persistStoredKeys,y=void 0!==p&&p,v=e.watchedKeys,m=e.connect,h=void 0===m?{}:m,_=e.tag,C=void 0===_?"":_,g=e.ccOption,K=void 0===g?{}:g,S=u,E=a.setState,w=a.forceUpdate;s!==re&&(E=a.setState.bind(a),w=a.forceUpdate.bind(a));var b={};b.persistStoredKeys=void 0===K.persistStoredKeys?y:K.persistStoredKeys,b.tag=K.tag||C;var N=function(e,t,r,n){var o;if(e)r&&Bn("now the ccClass is singleton, you needn't supply ccKey to instance props, cc will ignore the ccKey["+r+"]"),o=t;else if(r)o=Gn(t,r);else{var a=ft(n);o=Gn(t,a)}return o}(n,c,i,b.tag);if(b.renderKey=K.renderKey||N,fo(co,b.renderKey).push(N),b.storedKeys=function(e,t,r,n){var o=r||n;return o?"*"===o?Object.keys(e).filter(function(e){return!t.includes(e)}):(Qe(t,o),o):[]}(d,no[S],K.storedKeys,f),i&&!c)throw Error("missing ccClassKey while init a cc ins with ccKey["+i+"]");if(0<b.storedKeys.length&&!i)throw so(ue.CC_STORED_KEYS_NEED_CCKEY,lo("ccClassKey["+c+"]"));var O=ro[c],I=O.connectedComputed||{},U=O.connectedState||{},x=oo(u),D=io[u]||{},A=io[te]||{},R=oo(te),T=fe(uo(d),no[S]),k=to._state[N]||{},$=Object.assign({},d,k,x),M=uo(a.state=$);Un(a,n,c,i,N);var F=le(ao,u);F.includes(c)||F.push(c);function L(e,t){Cr(e,t,a)}function j(e,t,r,n,o,a){L(t,{calledBy:r,module:e,renderKey:o,delay:a,reactCallback:n})}function P(e,t,r,n,o){j(e,t,ae,r,n,o)}function z(e,t,r,n,o){"string"==typeof e?P(e,t,r,n,o):j(S,e,oe,t,r,n)}function H(e,t,r){j(S,a.state,ie,e,t,r)}var q=[],V=[],B=[],G={effectItems:V,eid_effectReturnCb_:{},effectPropsItems:B,eid_effectPropsReturnCb_:{}},W={},Y={},X=Wn(a.props),J=((r={type:s,isSingle:n,module:u,ccClassKey:c,ccKey:i,ccUniqueKey:N,renderCount:1,initTime:Date.now(),watchedKeys:v,privStateKeys:T,connect:h,persistStoredKeys:b.persistStoredKeys,storedKeys:b.storedKeys,renderKey:b.renderKey,tag:b.tag,prevProps:X,props:X,mapped:{},prevState:$,state:$,moduleState:x,globalState:R,connectedState:U,extra:{},staticExtra:{},refComputed:{},moduleComputed:D,globalComputed:A,connectedComputed:I,moduleReducer:{},connectedReducer:{},reducer:{}}).mapped={},r.prevModuleStateVer={},r.stateKeys=M,r.onEvents=q,r.computedDep={},r.computedRetKeyFns={},r.watchDep={},r.watchRetKeyFns={},r.execute=null,r.auxMap=W,r.effectMeta=G,r.retKey_fnUid_={},r.reactSetState=vo,r.__boundSetState=E,r.reactForceUpdate=vo,r.__boundForceUpdate=w,r.setState=z,r.setModuleState=P,r.forceUpdate=H,r.changeState=L,r.refs=Y,r.useRef=function(t){return function(e){return Y[t]={current:e}}},r.__$$ccSetState=jr(a),r.__$$ccForceUpdate=Pr(a),r);a.ctx=J,a.setState=z,a.forceUpdate=H,J.initState=function(e){return a.__$$isBF?de(d)?(a.state=Object.assign({},d,e,k,x),void(J.prevState=J.state=a.state)):po("state "+se):po("ctx.initState can only been called before first render period!")};var Z=qr(a,!1,!1,S);if(J.dispatch=Z,1<t&&(J.lazyDispatch=qr(a,!0,!1,S),J.silentDispatch=qr(a,!1,!0,S),J.dispatchLazy=J.lazyDispatch,J.dispatchSilent=J.silentDispatch,J.invoke=zr(a),J.lazyInvoke=zr(a,{isLazy:!0}),J.silentInvoke=zr(a,{isLazy:!1,isSilent:!0}),J.invokeLazy=J.lazyInvoke,J.invokeSilent=J.silentInvoke,J.setGlobalState=function(e,t,r,n){j(te,e,oe,t,r,n)}),2<t&&(J.syncBool=function(e,t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r=-1),"string"==typeof e)return eo.bind(null,((n={})[ne]=e,n.type="bool",n.delay=r,n.rkey=t,n),a);eo({type:"bool"},e,a)},J.sync=function(e,t,r,n){var o;if(void 0===r&&(r=""),void 0===n&&(n=-1),"string"==typeof e)return eo.bind(null,((o={})[ne]=e,o.type="val",o.val=t,o.delay=n,o.rkey=r,o),a);eo({type:"val"},a,e)},J.set=function(e,t,r,n){var o;void 0===r&&(r=""),void 0===n&&(n=-1),eo(((o={})[ne]=e,o.type="val",o.val=t,o.delay=n,o.rkey=r,o),a)},J.setBool=function(e,t,r){var n;void 0===t&&(t=""),void 0===r&&(r=-1),eo(((n={})[ne]=e,n.type="bool",n.delay=r,n.rkey=t,n),a)},J.syncInt=function(e,t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r=-1),"string"==typeof e)return eo.bind(null,((n={})[ne]=e,n.type="int",n.delay=r,n.rkey=t,n),a);eo({type:"int"},a,e)}),3<t){J.emit=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];jn.apply(qn,[Hn(e)].concat(r))},J.off=function(e,t){var r=void 0===t?{}:t,n=r.module,o=r.ccClassKey,a=r.ccUniqueKey,i=void 0===a?N:a,c=Hn(e);Pn(c.name,{module:n,ccClassKey:o,ccUniqueKey:i,identity:c.identity})};var Q=function(e,t,r){void 0===r&&(r=!0);var n=Hn(e),o=n.name,a=n.identity,i=void 0===a?null:a;r?q.push({event:o,handler:t,identity:i}):Ln(S,c,N,o,i,t)};J.on=Q,J.onDirectly=function(e,t){Q(e,t,!1)}}if(4<t){J.execute=function(e){return J.execute=e},J.aux=function(e,t){if(W[e])throw Error("auxMethod["+e+"] already defined!");W[e]=t},J.watch=function(a){return function(e,t,r,n,o){vt(ce,{type:"watch",refCtx:a,stateKeys:a.stateKeys,retKeyFns:a.watchRetKeyFns,module:a.module,connect:a.connect,dep:a.watchDep},e,t,r,n,o)}}(J),J.computed=Vn(J),J.lazyComputed=Vn(J,!0);var ee=function(i){return function(e,t,r,n){var o;if(void 0===r&&(r=!0),"function"!=typeof e)throw Error(mo("first")+" function");if(null!=t&&!Array.isArray(t))throw Error(mo("second")+" one of them(array, null, undefined)");var a=((o={fn:e,depKeys:t,eId:n||Symbol("__autoGen_"+ ++yo+"__")}).depKeys=t,o.immediate=r,o);i.push(a)}};J.effect=ee(V),J.effectProps=ee(B)}}var _o=Pe.store.getState;var Co=W,go=J,Ko=P,So=Pe.reducer,Eo=So._module_fnNames_,wo=So._caller,bo=Pe.runtimeVar;function No(r,e,t){r.__$$isUnmounted=!1,r.__$$isBF=!0;var n=r.ctx;n.__$$isBSe=!0;var a=n.connectedReducer,i=n.moduleReducer,c=n.dispatch,u=n.module,o=go(n.connect).slice();if(o.includes(u)?Ko("module["+u+"] is in belongTo and connect both, it will cause redundant render."):o.push(u),o.forEach(function(o){var e;e=o===u?i:Co(a,o),(Eo[o]||[]).forEach(function(n){e[n]=function(e,t,r){return c(o+"/"+n,e,t,r)}})}),n.reducer=wo,e){if("function"!=typeof e)throw Error("type of setup must be function");var s=e(n)||{};if(!de(s))throw Error("type of setup return result must be an plain json object");(!0===t||!0===bo.bindCtxToMethod&&!1!==t)&&go(s).forEach(function(e){var t=s[e];"function"==typeof t&&(s[e]=t.bind(r,n))}),n.settings=s}n.__$$isBSe=!1,function(e){var n=e.ctx,t=n.hasComputedFn,r=n.hasWatchFn,o=n.connect,a=n.module,i=_e(a),c=J(o),u=n.state;t&&(qt(n,a,u,u,i,!0,!0),c.forEach(function(e){var t=_o(e),r=_e(e);qt(n,e,t,t,r,!0,!0)})),r&&(Ht(n,a,u,u,i,!0,!0),c.forEach(function(e){var t=_o(e),r=_e(e);Ht(n,e,t,t,r,!0,!0)}))}(r)}var Oo=Pe.moduleName_stateKeys_,Io=Pe.store,Uo=Io.getPrevState,xo=Io.getState,Do=Io.getStateVer,Ao=function(e,t){return P("effect: key["+e+"] is invalid, its "+t+" has not been declared in' store!")};function Ro(e,t){function r(o,a,i){return function(e){var t=e.eId;if(!i||!1!==e.immediate){var r=o[t],n=(0,e.fn)(m,a);n&&(o[t]=n),r&&r(m)}}}var m=e.ctx,n=m.effectMeta,o=n.effectItems,a=n.eid_effectReturnCb_,i=n.effectPropsItems,c=n.eid_effectPropsReturnCb_,h=m.prevModuleStateVer;if(t)o.forEach(r(a,!0,!0)),i.forEach(r(c,!0,!0));else{var _=m.prevState,C=e.state,g=[];o.forEach(function(e){var t=e.depKeys,r=e.fn,n=e.eId;if(t){var o=t.length;if(0===o)return;for(var a=!1,i=0;i<o;i++){var c=t[i],u=void 0,s=void 0,d=void 0;if(c.includes("/")){var l=c.split("/"),f=l[0],p=l[1],y=Uo(f),v=Do(f);if(h[p]===v[p])continue;if(m.prevModuleStateVer[p]=v[p],!y){Ao(c,"module["+f+"]");continue}if(!Oo[f].includes(p)){Ao(c,"unmoduledKey["+p+"]");continue}u=xo(f),s=y,d=p}else u=C,s=_,d=c;if(s[d]!==u[d]){a=!0;break}}a&&g.push({fn:r,eId:n})}else g.push({fn:r,eId:n})}),g.forEach(r(a,!1,!1));var u=m.prevProps,s=m.props,d=[];i.forEach(function(e){var t=e.depKeys,r=e.fn,n=e.eId;if(t){var o=t.length;if(0===o)return;for(var a=!1,i=0;i<o;i++){var c=t[i];if(u[c]!==s[c]){a=!0;break}}a&&d.push({fn:r,eId:n})}else d.push({fn:r,eId:n})}),d.forEach(r(c,!1,!1))}}function To(e){e.__$$isBF=!1;var t=e.ctx,r=t.module,n=t.ccClassKey,o=t.ccUniqueKey;t.onEvents.forEach(function(e){Ln(r,n,o,e.event,e.identity,e.handler)}),Ro(e,!0)}function ko(e){Ro(e),e.ctx.prevState=e.state}var $o=Pe.ccUkey_ref_,Mo=Pe.ccUKey_handlerKeys_,Fo=Pe.runtimeVar,Lo=Pe.ccClassKey_ccClassContext_,jo=Pe.handlerKey_handler_,Po=Pe.renderKey_ccUkeys_;function zo(e,t,r){Fo.isDebug&&console.log(L(t+" unset ref"),A("purple")),delete $o[t];var n=Po[r];r===t?delete Po[r]:n.splice(n.indexOf(t),1);var o=Lo[e].ccKeys,a=o.indexOf(t);a<0||o.splice(a,1),function(e){void 0===On[e]?On[e]=0:On[e]-=1}(t);var i=Mo[t];i&&i.forEach(function(e){delete jo[e]})}var Ho=J;function qo(r,n){function e(e){var t=r[e];"function"==typeof t&&t(n)}Object.getOwnPropertySymbols(r).forEach(e),Ho(r).forEach(e)}function Vo(e){e.__$$isUnmounted=!0;var t=e.ctx,r=t.effectMeta,n=r.eid_effectPropsReturnCb_;qo(r.eid_effectReturnCb_,t),qo(n,t);var o=t.ccUniqueKey,a=t.ccClassKey,i=t.renderKey;zn(o),zo(a,o,i)}var Bo=function(e){return"CC("+e+")"},Go=J,Wo=ee,Yo=Ce,Xo=Pe.runtimeVar,Jo=A,Zo=L,Qo=function(e){return Error("can not defined setup both in register options and class body --verbose:"+e)};function ea(e,t){var r=void 0===e?{}:e,n=r.module,o=void 0===n?H:n,a=r.state,u=void 0===a?{}:a,i=r.watchedKeys,c=void 0===i?"*":i,s=r.storedKeys,d=void 0===s?[]:s,l=r.setup,f=void 0===l?null:l,p=r.persistStoredKeys,y=r.connect,v=void 0===y?{}:y,m=r.tag,h=r.lite,_=r.isPropsProxy,C=void 0!==_&&_,g=r.isSingle,K=void 0!==g&&g,S=r.renderKeyClasses,E=r.__checkStartUp,w=void 0===E||E,b=r.compareProps,N=void 0===b||b,O=r.__calledBy;void 0===t&&(t="");try{var I=_n(o,t,S,T,c,d,v,w,O),U=I._module,x=I._watchedKeys,D=I._ccClassKey,A=I._connect;return function(r){if(r.prototype&&r.prototype.$$attach)throw Error("register a cc class is prohibited!");var e=!1===C?r:R.Component,c=e.$$setup,t=function(i){function e(e,t){var r;try{r=i.call(this,e,t)||this;var n=Yo(u),o=Object.assign(r.state||{},n);r.$$attach=r.$$attach.bind(Qr(r));var a=Object.assign({},e,{isSingle:K,module:U,tag:m,state:o,type:T,watchedKeys:x,ccClassKey:D,connect:A,storedKeys:d,persistStoredKeys:p});if(ho(Qr(r),a,h),r.ctx.reactSetState=Br(Qr(r)),r.ctx.reactForceUpdate=Gr(Qr(r)),f&&(r.$$setup||c))throw Qo("ccUniqueKey "+r.ctx.ccUniqueKey);r.$$setup&&(r.$$setup=r.$$setup.bind(Qr(r))),No(Qr(r),f||r.$$setup||c,!1)}catch(e){xt(e)}return r}Zr(e,i);var t=e.prototype;return t.shouldComponentUpdate=function(e,t){var r=this.ctx.childRef;if(r&&r.shouldComponentUpdate)return r.shouldComponentUpdate(e,t);if(i.prototype.shouldComponentUpdate)return i.prototype.shouldComponentUpdate.call(this,e,t);var n=!!N&&Wo(this.props,e);return this.state!==t||n},t.$$attach=function(e){var t=this.ctx;((t.childRef=e).ctx=t).reactSetState=e.setState.bind(e),t.reactForceUpdate=e.forceUpdate.bind(e),e.setState=t.setState,e.forceUpdate=t.forceUpdate,t.__$$ccSetState=jr(e,this),t.__$$ccForceUpdate=Pr(e);var r=e.state,n=this.state;r||(r=e.state={});var o=Object.assign({},r,n);if(Go(t.state=e.state=o).forEach(function(e){return n[e]=o[e]}),e.$$setup&&(e.$$setup=e.$$setup.bind(e)),f&&(e.$$setup||c))throw Qo("ccUniqueKey "+t.ccUniqueKey);No(e,f||e.$$setup||c,!1)},t.componentDidMount=function(){i.prototype.componentDidMount&&i.prototype.componentDidMount.call(this),To(this)},t.componentDidUpdate=function(){i.prototype.componentDidUpdate&&i.prototype.componentDidUpdate.call(this),ko(this)},t.componentWillUnmount=function(){i.prototype.componentWillUnmount&&i.prototype.componentWillUnmount.call(this),Vo(this)},t.render=function(){return this.ctx.prevProps=this.ctx.props,this.ctx.props=this.props,Xo.isDebug&&console.log(Zo("@@@ render "+Bo(D)),Jo()),!1===C?i.prototype.render.call(this):R.createElement(r,{ctx:this.ctx,$$attach:this.$$attach})},e}(e);return t.displayName=D===B?"CcDispatcher":Bo(D),t}}catch(e){xt(e)}}function ta(e){var t=function(e){function t(){return e.apply(this,arguments)||this}return Zr(t,e),t.prototype.render=function(){return this.props.children||R.createElement("span",{style:{display:"none"}})},t}(R.Component);if(Pe.refs[B]){if(!Pe.isHotReloadMode())throw Error("CcDispatcher can only be initialize one time");z("hot reload mode, CC_DISPATCHER existed")}var r=e||t;return ea({isSingle:!0,__checkStartUp:!1,__calledBy:"cc"},B)(r)}var ra=de,na=J;function oa(e,t){if(!ra(e))throw Error(t+" "+se)}function aa(e){if(!ra(e))throw Error("StartupOption.moduleSingleClass "+se);!function(t,r){Object.keys(r).forEach(function(e){t[e]=r[e]})}(Pe.moduleSingleClass,e)}function ia(e){if(0<e.length){var o=Pe.plugins;o.length=0,Nt.forEach(function(e){return Ot[e].length=0});var a={};e.forEach(function(e){if(o.push(e),!e.install)throw Error("a plugin must export install handler!");var t=e.install(Ut),r=Error("plugin.install must return result:{name:string, options?:object}");if(!t)throw r;var n=t.name;if(!n)throw r;if(a[n])throw Error("pluginName["+n+"] duplicate");a[n]=1})}}var ca=function(e){var t=document.querySelector("#"+a);if(!t){(t=document.createElement("div")).id=a;var r=t.style;r.position="fixed",r.left=0,r.top=0,r.display="none",r.zIndex=-888666,document.body.appendChild(t)}n.render(R.createElement(e),t)},ua=!1;function sa(e){void 0===e&&(e=!1),X(Pe.event_handlers_),X(Pe.ccUKey_handlerKeys_),X(Pe.renderKey_ccUkeys_);var t=Pe.ccClassKey_ccClassContext_;if(Object.keys(t).forEach(function(e){X(t[e].ccKeys)}),X(Pe.handlerKey_handler_),X(Pe.ccUkey_ref_,[B]),X(Pe.refs,[B]),e){var r=Pe.computed,n=Pe.watch,o=r._computedValue,a=n._watchDep;J(Pe.store._state).forEach(function(e){e!==q&&(o[e]&&(Pe.computed._computedDep[e]={retKey_fn_:{},stateKey_retKeys_:{},fnCount:0},Kt(e,r._computedRaw[e])),a[e]&&(a[e]={retKey_fn_:{},stateKey_retKeys_:{},fnCount:0},bt(e,n._watchRaw[e])))})}}function da(){X(Pe.globalStateKeys);var e=J(Pe.moduleName_isConfigured_).concat([H,q,te,o]);X(Pe.reducer._reducer,e),X(Pe.store._state,e,{}),X(Pe.computed._computedDep,e),X(Pe.computed._computedValue,e),X(Pe.watch._watchDep,e),X(Pe.middlewares),ge={module:{computed:{},watch:{}},ref:{computed:{},watch:{},effect:{}}},sa()}function la(e){void 0===e&&(e=!1),Pe.info.latestStartupTime=Date.now(),function(e){Pe.isStartup?Pe.isHotReloadMode()?e():console.warn("clear failed because of not running under hot reload mode!"):ua=!0}(function(){if(e)console.warn("attention: make sure [[clearContextIfHot]] been called before app rendered!"),ua=!0,da();else{if(ua)return void(ua=!1);!function(){if(!Pe.refs[B]){var e=ta();ca(e)}}(),sa(Pe.reComputed)}})}var fa=z,pa=Q,ya="";function va(e,t){var r=void 0===e?{}:e,n=r.store,o=void 0===n?{}:n,a=r.reducer,i=void 0===a?{}:a,c=r.init,u=void 0===c?null:c,s=r.computed,d=void 0===s?{}:s,l=r.watch,f=void 0===l?{}:l,p=r.moduleSingleClass,y=void 0===p?{}:p,v=void 0===t?{}:t,m=v.plugins,h=void 0===m?[]:m,_=v.middlewares,C=void 0===_?[]:_,g=v.isStrict,K=void 0!==g&&g,S=v.isDebug,E=void 0!==S&&S,w=v.errorHandler,b=void 0===w?null:w,N=v.isHot,O=v.bindCtxToMethod,I=void 0!==O&&O,U=v.computedCompare,x=void 0===U||U,D=v.watchCompare,A=void 0===D||D,R=v.watchImmediate,T=void 0!==R&&R,k=v.alwaysGiveState,$=void 0===k||k,M=v.reComputed,F=void 0===M||M,L=!0;try{throw Error()}catch(e){L=function(e){function t(e,t){for(var r=0;r<o;r++)if(n[r].includes(e)){a=n[r+t];break}}var r=Pe.info,n=e.stack.split("\n"),o=n.length,a="";function i(){la(Pe.isHot=!0)}t("startup",2),a||t("runConcent",0);var c=Date.now();if(ya)if(ya!==a){var u="invalid run api call!(it can only be called once, changing 'call run' line location in HMR will cause this error also, \n    try refresh browser to reload your app to avoid this tip)";if(c-r.latestStartupTime<1e3)throw Error(u);if(!he())return G(u),!1;i(),ya=a}else i();else ya=a,r.firstStartupTime=c,r.latestStartupTime=c;return!0}(e)}if(L)try{console.log("%c window.name:"+window.name,"color:green;border:1px solid green"),fa("cc version "+Pe.info.version),void 0!==N&&(Pe.isHot=N),Pe.reComputed=F,Pe.errorHandler=b;var j=Pe.runtimeVar;if(j.alwaysGiveState=$,j.isStrict=K,j.isDebug=E,j.computedCompare=x,j.watchCompare=A,j.watchImmediate=T,j.bindCtxToMethod=I,aa(y),function(e){oa(e,"state"),delete e[V],delete e[q],void 0===e[te]&&(e[te]={}),void 0===e[H]&&(e[H]={});for(var t=na(e),r=t.length,n=0;n<r;n++){var o=t[n];rt(o,e[o])}}(o),function(t){oa(t,"reducer"),void 0===t[H]&&(t[H]={}),void 0===t[te]&&(t[te]={}),na(t).forEach(function(e){return st(e,t[e])})}(i),function(t){oa(t,"computed"),na(t).forEach(function(e){return Kt(e,t[e])})}(d),function(t){oa(t,"watch"),Object.keys(t).forEach(function(e){return bt(e,t[e])})}(f),function(r){if(r){if(!ra(r))throw Error("init "+se);na(r).forEach(function(t){Ze(t,!1);var e=r[t];e&&Promise.resolve().then(e).then(function(e){Vr(t)(e)})}),Pe.init._init=r}}(u),function(e){if(0<e.length){var t=Pe.middlewares;t.length=0,e.forEach(function(e){return t.push(e)})}}(C),!Pe.refs[B]){var P=ta();ca(P)}var z=function(e){pa("CC_CONTEXT",Pe,e),pa("ccc",Pe,e),pa("cccc",Pe.computed._computedValue,e),pa("sss",Pe.store._state,e)};window.mcc?setTimeout(function(){z(window.mcc[ve()])},1200):z(),Pe.isStartup=!0,ia(h)}catch(e){if(!b)throw e;b(e)}}function ma(e){throw Error("[[run]]: param error, "+e+" "+se)}var ha=de,_a=J,Ca=S,ga=Ce;function Ka(e,t){var r=pe(e);return delete r.__checkStartUp,delete r.__calledBy,ea(r,t)}var Sa=ee,Ea=pe,wa=Ce,ba=R.createElement("span",{style:{display:"none"}}),Na=function(I){function e(e,t){var r;r=I.call(this,e,t)||this;var n=Ea(e.register),o=n.module,a=n.renderKeyClasses,i=n.tag,c=n.lite,u=n.compareProps,s=void 0===u||u,d=n.setup,l=n.bindCtxToMethod,f=n.watchedKeys,p=void 0===f?"*":f,y=n.connect,v=void 0===y?{}:y,m=n.isSingle,h=n.storedKeys,_=void 0===h?[]:h,C=wa(n.state),g=e.ccClassKey,K=e.ccKey,S=e.ccOption,E=void 0===S?{}:S,w=p,b=g,N=v;if(!0!==e.__$$regDumb){var O=_n(o,g,a,U,p,_,v,!0);w=O._watchedKeys,b=O._ccClassKey,N=O._connect}return ho(Qr(r),{isSingle:m,ccKey:K,connect:N,state:C,module:o,storedKeys:_,watchedKeys:w,tag:i,ccClassKey:b,ccOption:E,type:U},c),r.ctx.reactSetState=Br(Qr(r)),r.ctx.reactForceUpdate=Gr(Qr(r)),r.__$$compareProps=s,No(Qr(r),d,l),r}Zr(e,I);var t=e.prototype;return t.componentDidMount=function(){To(this)},t.shouldComponentUpdate=function(e,t){var r=!!this.__$$compareProps&&Sa(Wn(e),Wn(this.props));return this.state!==t||r},t.componentDidUpdate=function(){ko(this)},t.componentWillUnmount=function(){I.prototype.componentWillUnmount&&I.prototype.componentWillUnmount.call(this),Vo(this)},t.render=function(){var e=this.props;this.ctx.prevProps=this.ctx.props,this.ctx.props=Wn(e);var t=e.render,r=t||e.children;if("function"==typeof r){var n=e.register,o=void 0===n?{}:n,a=this.ctx;return!0!==e.__$$regDumb&&o.mapProps?(a.mapped=o.mapProps(a)||{},r(a.mapped)||ba):r(a)||ba}if(R.isValidElement(r))throw Error("CcFragment's children can not b a react dom ");return r},e}(R.Component);function Oa(e,t){var r=pe(e),n=r.watchedKeys,o=r.render,a=r.connect,i=_n(r.module,t,r.renderKeyClasses,U,void 0===n?"*":n,r.storedKeys,void 0===a?{}:a,!0),c=i._watchedKeys,u=i._ccClassKey,s=i._connect;function d(t){return function(e){return r.props=e,function(t,e){var r=e.mapProps,n=e.props,o=void 0===n?{}:n,a={__$$regDumb:!0,props:o,ccOption:o.ccOption,ccClassKey:e.ccClassKey,render:function(e){return r?(e.mapped=r(e),R.createElement(t,e.mapped)):R.createElement(t,e)},ccKey:o.ccKey,register:e};return R.createElement(Na,a)}(t,r)}}return r.module=i._module,r.watchedKeys=c,r.ccClassKey=u,r.connect=s,o?d(o):function(e){return d(e)}}var Ia=Pe.ccUkey_ref_,Ua=1,xa={};function Da(e,t,r){this.setState=t,this.forceUpdate=t,this.state=e,this.isFirstRendered=!0,this.props=r}function Aa(e,t,r,n,o,a,i,c,u){var s=t||Ce(r),d=n.bindCtxToMethod,l=n.watchedKeys,f=n.storedKeys,p=n.connect,y=n.setup,v=n.lite;Ua+=1;var m=_n(n.module,u,n.renderKeyClasses,re,void 0===l?"*":l,void 0===f?[]:f,void 0===p?{}:p,!0),h=m._module,_=m._watchedKeys,C=m._ccClassKey,g=m._connect,K=new Da(o,a,i),S=Object.assign({},n,{module:h,watchedKeys:_,state:s,type:re,cursor:e,ccClassKey:C,connect:g,ccOption:i.ccOption});K.props=i,ho(K,S,v),K.ctx.reactSetState=Br(K),K.ctx.reactForceUpdate=Gr(K);var E=K.ctx;return E.props=i,E.extra=c,No(K,y,d),xa[e]=K.ctx.ccUniqueKey,E.useRef=function(e){var t=R.useRef(null);return E.refs[e]=t},K}var Ra="react version is LTE 16.8";function Ta(e,t){var r=pe(e),n=r.state,o=void 0===n?{}:n,a=r.props,i=void 0===a?{}:a,c=r.mapProps,u=r.layoutEffect,s=void 0!==u&&u,d=r.extra,l=void 0===d?{}:d,f=R.useState;if(!f)throw Error(Ra);function p(){return Aa(m,_,o,r,g,K,i,l,t)}var y,v=Ua,m=f(v)[0],h=m===v,_=h?Ce(o):0,C=f(_),g=C[0],K=C[1];if(h)y=p();else if(!(y=Ia[xa[m]])&&Date.now()-Pe.info.latestStartupTime<1e3)y=p();else{var S=y.ctx;S.prevProps=S.props,y.props=S.props=i,S.extra=l}var E=y.ctx,w=s?R.useLayoutEffect:R.useEffect;if(w(function(){y.isFirstRendered||ko(y)}),w(function(){if(!1===y.isFirstRendered){var e=y.ctx;Un(y,e.isSingle,e.ccClassKey,e.ccKey,e.ccUniqueKey)}else y.isFirstRendered=!1,To(y);return function(){Vo(y)}},[]),c){var b=c(E);if(!de(b))throw Error("mapProps ret "+se);E.mapped=b}return E}function ka(){throw Error("api doc: cc.setState(module:string, state:object, renderKey:string, delayMs?:number, skipMiddleware?:boolean, throwError?:boolean)")}function $a(e){return Pe.store.getState(e)}var Ma=Pe.computed._computedValue;var Fa=Pe.ccUkey_ref_,La=Pe.ccClassKey_ccClassContext_;function ja(){var r=[],n=Pe.ccUkey_ref_;return J(n).forEach(function(e){var t=n[e];t&&!t.__$$isUnmounted&&r.push(t)}),r}function Pa(e,t,r){var n=void 0===r?{}:r,o=n.state,a=n.reducer,i=n.computed,c=n.watch,u=n.init;if(!Pe.isStartup)throw Error("cc is not startup yet");Je(e),Ze(t,!1);var s=Pe.moduleName_stateFn_[t];if(!s)throw Error("target module["+t+"] state must be a function when use cloneModule");var d=s();Object.assign(d,Ce(o));var l=Jr(Pe.reducer._reducer[t]||{},e);a&&Object.assign(l,Jr(a,e));var f=Pe.computed._computedRaw[t]||{};i&&Object.assign(f,i);var p=Pe.watch._watchRaw[t]||{};c&&Object.assign(p,c);var y=Pe.init._init[t];u&&(y=u);var v={state:d,reducer:l,computed:f,watch:p};y&&(v.init=y),Xr(e,v)}function za(t,e){function n(e,t){var r=t.state,n=t.reducer,o=void 0===n?{}:n,a=t.watch,i=t.computed,c=t.init,u=t.isClassSingle;if(s.store[e])throw Error("run api error: module"+e+" duplicate");s.store[e]=ga(r),"function"==typeof r&&(Pe.moduleName_stateFn_[e]=r),s.reducer[e]=o,a&&(s.watch[e]=a),i&&(s.computed[e]=i),c&&(s.init[e]=c),s.moduleSingleClass[e]=!0===u}void 0===t&&(t={}),void 0===e&&(e={}),ha(t)||ma("store"),ha(e)||ma("options");var s={store:{},reducer:{},watch:{},computed:{},init:{},moduleSingleClass:{}};_a(t).forEach(function(e){return n(e,t[e])}),Be.forEach(function(e){var t=e.module,r=e.config;z("configure pending module["+t+"]"),n(t,r)}),Be.length=0,Ca(s.init)&&(s.init=null),va(s,e)}function Ha(e,t){return Ka({connect:e},t)}function qa(e,t){return Oa({connect:e},t)}function Va(e,o){var a=pe(e);function t(r){var e=a.memo,t=void 0===e||e;function n(){return function(e){a.props=e;var t=Ta(a,o);return R.createElement(r,a.mapProps?t.mapped:t)}}return delete a.memo,t&&R.memo?R.memo(n()):n()}"function"==typeof a.state&&(a.state=a.state());var r=a.render;return r?t(r):function(e){return t(e)}}function Ba(e,t,r,n,o){void 0===o&&(o=!1);try{nt().ctx.setGlobalState(e,t,r,n)}catch(e){if(o)throw e;P(e.message)}}function Ga(e,t,r,n,o,a){void 0===n&&(n=-1),void 0===a&&(a=!1),void 0===e&&void 0===t&&ka(),"string"!=typeof e&&ka(),Kr(e,t,r,n,o)}function Wa(e,t,r,n){nt().ctx.set(e,t,r,n)}function Ya(e,t){if(!e.includes("/"))throw Error("keyPath must start with module");var r=e.split("/"),n=$a(r[0]);return Zn(e,t,!1,n,!1).state}function Xa(e){return ci[e].connectedState||{}}function Ja(e){return e?Ma[e]:Ma}function Za(e){if(void 0===e)throw Error("api doc: cc.emit(event:string|{name:string, identity?:string, ctx?:boolean}, ...args)");try{for(var t,r=nt(),n=arguments.length,o=Array(1<n?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];(t=r.ctx).emit.apply(t,[e].concat(o))}catch(e){P(e)}}function Qa(e,t){try{nt().ctx.off(e,t)}catch(e){if(t.throwError)throw e;P(e.message)}}function ei(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];(function(e){var r=[],t=La[e];return t&&t.ccKeys.forEach(function(e){var t=Fa[e];t&&r.push(t)}),r})(e).forEach(function(e){var t;e.__$$isUnmounted||e.ctx.execute&&(t=e.ctx).execute.apply(t,r)})}function ti(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];ja().forEach(function(e){var t;e.ctx.execute&&(t=e.ctx).execute.apply(t,r)})}function ri(e,t,r){return{fn:e,depKeys:t,compare:r}}function ni(e,t,r){return{fn:e,depKeys:t,compare:r,lazy:!0}}function oi(e,t){return void 0===t&&(t=!0),{fn:function(){return e},depKeys:[],compare:t}}function ai(e,t,r,n){return{fn:e,depKeys:t,compare:r,immediate:n}}function ii(e,t,r){return{fn:e,depKeys:t,compare:r,immediate:!0}}var ci=Pe.ccClassKey_ccClassContext_,ui=Ka,si=Oa,di=Xr,li=$a,fi=Pe.store.getGlobalState,pi=ut,yi=Pe,vi=ta,mi=ja,hi=Pe.reducer._caller,_i=la,Ci=Na,gi=u,Ki=Pe.store.appendState,Si=Ta,Ei={cloneModule:Pa,emit:Za,off:Qa,connect:Ha,connectDumb:qa,register:ui,registerDumb:si,registerHookComp:Va,configure:di,dispatch:pi,run:za,setGlobalState:Ba,setState:Ga,set:Wa,setValue:Ya,getGlobalState:fi,getState:li,getComputed:Ja,getConnectedState:Xa,ccContext:yi,createDispatcher:vi,execute:ei,executeAll:ti,getRefs:mi,reducer:hi,clearContextIfHot:_i,CcFragment:Ci,cst:gi,appendState:Ki,useConcent:Si,bindCcToMcc:wi,defComputed:ri,defLazyComputed:ni,defComputedVal:oi,defWatch:ai,defWatchImmediate:ii};function wi(e){if(!Ni)throw Error("current env is not multi concent ins mode");if(Ni[e])throw Error("ccNamespace["+e+"] already existed in window.mcc");!function(e){ye=e}(e),Q(e,Ei,Ni)}function bi(){var e=ye?window.mcc[ye]:window.cc;if(e&&e.ccContext&&e.ccContext.info){var t=e.ccContext.info.version,r=yi.info.version;if(t!==r)throw Error("a existed version concent "+t+" is different with current about to import concent "+r+", \n        it may caused by some of your concent-eco-module with older version concent, please reinstall them (concent-*** module)")}}var Ni=window.mcc;Ni?setTimeout(function(){if(!ve())throw Error("detect window.mcc, but user forget call bindCcToMcc in bundle entry");bi()},1e3):(bi(),Q("cc",Ei)),e.cloneModule=Pa,e.run=za,e.connect=Ha,e.connectDumb=qa,e.register=ui,e.registerDumb=si,e.registerHookComp=Va,e.configure=di,e.setGlobalState=Ba,e.setState=Ga,e.set=Wa,e.setValue=Ya,e.getState=li,e.getGlobalState=fi,e.getConnectedState=Xa,e.getComputed=Ja,e.emit=Za,e.off=Qa,e.dispatch=pi,e.ccContext=yi,e.createDispatcher=vi,e.execute=ei,e.executeAll=ti,e.getRefs=mi,e.reducer=hi,e.clearContextIfHot=_i,e.CcFragment=Ci,e.cst=gi,e.appendState=Ki,e.useConcent=Si,e.defComputed=ri,e.defLazyComputed=ni,e.defComputedVal=oi,e.defWatch=ai,e.defWatchImmediate=ii,e.bindCcToMcc=wi,e.default=Ei,Object.defineProperty(e,"__esModule",{value:!0})});
