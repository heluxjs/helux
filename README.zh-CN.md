[English](./README.md) | ç®€ä½“ä¸­æ–‡

## [concent](https://concentjs.github.io/concent-doc)
ä¸€ä¸ªå¯é¢„æµ‹ã€0å…¥ä¾µã€æ¸è¿›å¼ã€é«˜æ€§èƒ½çš„å¢å¼ºå‹çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼ŒåŸºäº**ä¾èµ–æ ‡è®°**ã€**å¼•ç”¨æ”¶é›†**å’Œ**çŠ¶æ€åˆ†å‘**åŸç†ï¼Œpower you react!

äº†è§£æ›´å¤šè¯·è®¿é—®å®˜æ–¹æ–‡æ¡£[https://concentjs.github.io/concent-doc](https://concentjs.github.io/concent-doc).

<p align="center">
  <a href="#">
    <img width="500" src="https://raw.githubusercontent.com/concentjs/concent-site/master/img/banner.png">
  </a>
</p>

<br/>

<!--- é¢å¤–åŒ…ä¸€ä¸ªpæ ‡ç­¾ï¼Œé˜²æ­¢æŸäº›mdè§£æå™¨è‡ªå·±åŒ…ä¸€ä¸ªpæ ‡ç­¾ï¼Œè¿›è€Œç ´åæ ·å¼ --->
<div style="display:flex; flex-wrap: wrap">

  <a href='https://www.npmjs.com/package/concent' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/package-json/v/concentjs/concent/master.svg?label=npm%20version' alt='npm version' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/issues/concentjs/concent.svg' alt='issues open' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/npm/dw/concent.svg?label=downloads' alt='downloads' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/last-commit/concentjs/concent.svg' alt='last commit' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/commit-activity/m/concentjs/concent.svg' alt='commit activity' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/npm/l/concent.svg' alt='license:MIT' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <!--   i don't konw why this badge message is wrong -->
  <!--   <img src='https://img.shields.io/bundlephobia/minzip/concent/1.4.1.svg' alt='mini bundle size' height='18'> -->
  <img src='https://img.shields.io/badge/minzipped-18kb-brightgreen' alt='mini bundle size' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/package-json/dependency-version/concentjs/concent/co.svg' alt='co version' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/followers/fantasticsoul.svg?style=social' alt='followers' height='18'>
  </a>

  <a href='#' style='margin: 0 0.5rem;'>
  <img src='https://img.shields.io/github/stars/concentjs/concent.svg?style=social' alt='concent star' height='18'>
  </a>

</div>
    
![hello-concent](https://raw.githubusercontent.com/fantasticsoul/assets/master/img/cc/hello.gif)

[review this gif](https://xvcej.csb.app/#/)


## ğŸ–¥åœ¨çº¿ä½“éªŒ
- å¿«é€Ÿå¼€å§‹:
<p>
<a href="https://codesandbox.io/s/green-tdd-g2mcr" rel="nofollow">
<img src="https://camo.githubusercontent.com/416c7a7433e9d81b4e430b561d92f22ac4f15988/68747470733a2f2f636f646573616e64626f782e696f2f7374617469632f696d672f706c61792d636f646573616e64626f782e737667" alt="Edit" data-canonical-src="https://codesandbox.io/static/img/play-codesandbox.svg" style="max-width:100%;"></a></p>

- ç»“åˆäº†concentç”Ÿæ€åº“çš„ä¼ä¸šçº§é¡¹ç›®æ¨¡æ¿(js):
<p>
<a href="https://codesandbox.io/s/concent-guide-xvcej" rel="nofollow">
<img src="https://camo.githubusercontent.com/416c7a7433e9d81b4e430b561d92f22ac4f15988/68747470733a2f2f636f646573616e64626f782e696f2f7374617469632f696d672f706c61792d636f646573616e64626f782e737667" alt="Edit" data-canonical-src="https://codesandbox.io/static/img/play-codesandbox.svg" style="max-width:100%;"></a></p>

- ç»“åˆäº†concentç”Ÿæ€åº“çš„ä¼ä¸šçº§é¡¹ç›®æ¨¡æ¿(ts):
<p>
<a href="https://codesandbox.io/s/concent-guide-ts-zrxd5" rel="nofollow">
<img src="https://camo.githubusercontent.com/416c7a7433e9d81b4e430b561d92f22ac4f15988/68747470733a2f2f636f646573616e64626f782e696f2f7374617469632f696d672f706c61792d636f646573616e64626f782e737667" alt="Edit" data-canonical-src="https://codesandbox.io/static/img/play-codesandbox.svg" style="max-width:100%;"></a></p>
source code see hereï¼šhttps://github.com/fantasticsoul/concent-guid-ts

## âœ¨ç‰¹æ€§
* **æç®€çš„æ ¸å¿ƒapi**ï¼Œ`run`è½½å…¥æ¨¡å—é…ç½®å¯åŠ¨concentï¼Œ`register`æ³¨å†Œç»„ä»¶ï¼Œæ— éœ€åŒ…ä¸€å±‚`Provider`åœ¨æ ¹ç»„ä»¶ã€‚
* **0å…¥ä¾µæˆæœ¬æ¥å…¥**ï¼Œä¸æ”¹é€ ä»£ç çš„æƒ…å†µä¸‹ç›´æ¥æ¥å…¥ï¼›[hello-concent](https://stackblitz.com/edit/cc-course-hello-concent-simple)
* **è´´å¿ƒçš„æ¨¡å—é…ç½®**ï¼Œé™¤äº†`state`ï¼Œè¿˜æä¾›`reducer`ã€`computed`ã€`watch`å’Œ`init`å››é¡¹å¯é€‰å®šä¹‰ã€‚
* **çµæ´»çš„æ•°æ®æ¶ˆè´¹ç²’åº¦**ï¼Œæ”¯æŒè·¨å¤šä¸ªæ¨¡å—åœºæ™¯ï¼Œä»¥åŠæ¨¡å—å†…stateKeyçº§åˆ«çš„ç»†ç²’åº¦æ§åˆ¶ã€‚
* **æ¸è¿›å¼æ„å»ºreactåº”ç”¨**ï¼Œé™¤äº†`setState`,æ”¯æŒ`dispatch`ã€`invoke`è°ƒç”¨æ¥è®©uiè§†å›¾ä¸ä¸šåŠ¡é€»è¾‘å½»åº•è§£è€¦ã€‚[ä»classåˆ°function](https://stackblitz.com/edit/cc-multi-ways-to-wirte-code)
* **ç»„ä»¶èƒ½åŠ›å¢å¼º**ï¼Œæ”¯æŒå®ä¾‹çº§åˆ«`computed`ã€`watch`å®šä¹‰,æ”¯æŒ`emit&on`,ä»¥åŠæ”¯æŒ`setup`ç‰¹æ€§ï¼Œè®©å‡½æ•°ç»„ä»¶æ‹¥æœ‰å®šä¹‰é™æ€apiçš„èƒ½åŠ›ã€‚
* **é«˜åº¦ä¸€è‡´çš„ç¼–ç¨‹ä½“éªŒ**ï¼Œ`hoc`ã€`render props`å’Œ`hook`3ç§æ–¹å¼å®šä¹‰çš„ç»„ä»¶å‡äº«æœ‰ä¸€è‡´çš„apiè°ƒç”¨ä½“éªŒï¼Œç›¸äº’åˆ‡æ¢ä»£ä»·ä¸º0ã€‚[å¤šç§æ–¹å¼å®šä¹‰ç»„ä»¶](https://stackblitz.com/edit/cc-4-render-mode)
* **æ¸²æŸ“æ€§èƒ½å‡ºä¼—**ï¼Œå†…ç½®`renderKey`ã€`lazyDispatch`ã€`delayBroadcast`ç­‰ç‰¹æ€§ï¼Œä¿è¯æé€Ÿçš„æ¸²æŸ“æ•ˆç‡ã€‚[é•¿åˆ—è¡¨ç²¾å‡†æ¸²æŸ“](https://stackblitz.com/edit/concent-render-key?file=BookItem.js)ã€[æ‰¹å¤„ç†çŠ¶æ€æäº¤](https://stackblitz.com/edit/concent-lazy-dispatch?file=runConcent.js)ã€[é«˜é¢‘è¾“å…¥åœºæ™¯çŠ¶æ€å»¶è¿Ÿåˆ†å‘](https://stackblitz.com/edit/concent-delay-broadcast)
* **å¹²å‡€çš„domå±‚çº§**ï¼Œå¯¹äºclassç»„ä»¶ï¼Œé»˜è®¤é‡‡ç”¨åå‘ç»§æ‰¿ç­–ç•¥ï¼Œè®©react domæ ‘çš„å±‚çº§ç»“æ„ä¿æŒç®€æ´ä¸å¹²å‡€ã€‚
* **æ‰©å±•ä¸­é—´ä»¶ä¸æ’ä»¶**ï¼Œå…è®¸ç”¨æˆ·å®šä¹‰ä¸­é—´ä»¶æ‹¦æˆªæ‰€æœ‰çš„æ•°æ®å˜æ›´æäº¤è®°å½•ï¼Œåšé¢å¤–å¤„ç†ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ’ä»¶ï¼Œæ¥æ”¶è¿è¡Œæ—¶çš„å‘å‡ºçš„å„ç§ä¿¡å·ï¼ŒæŒ‰éœ€å¢å¼ºconcentè‡ªèº«çš„èƒ½åŠ›ã€‚
* **å»ä¸­å¿ƒåŒ–é…ç½®æ¨¡å—**ï¼Œé™¤äº†`run`æ¥å£ä¸€æ¬¡æ€§é…ç½®æ¨¡å—ï¼Œè¿˜æä¾›`configure`æ¥å£åœ¨ä»»æ„åœ°æ–¹åŠ¨æ€é…ç½®æ¨¡å—ã€‚
* **æ¨¡å—å…‹éš†**ï¼Œæ”¯æŒå¯¹å·²å®šä¹‰æ¨¡å—è¿›è¡Œå…‹éš†,æ»¡è¶³ä½ é«˜ç»´åº¦æŠ½è±¡çš„éœ€è¦ã€‚
* **å®Œæ•´çš„typescriptæ”¯æŒ**ï¼Œèƒ½å¤Ÿéå¸¸å®¹æ˜“åœ°ä¹¦å†™[ä¼˜é›…çš„tsä»£ç ](https://codesandbox.io/s/concent-guide-ts-zrxd5)ã€‚

## æ­é…react-routerä½¿ç”¨
è¯·ç§»æ­¥é˜…è¯»å’Œäº†è§£[react-router-concent](https://github.com/concentjs/react-router-concent)ï¼Œæš´éœ²`history`å¯¹è±¡ï¼Œå¯ä»¥å…¨å±€ä»»æ„åœ°æ–¹ä½¿ç”¨ï¼Œäº«å—ç¼–ç¨‹å¼çš„å¯¼èˆªè·³è½¬ã€‚

[react-router-concentåœ¨çº¿ç¤ºä¾‹](https://stackblitz.com/edit/cc-multi-ways-to-wirte-code)

## æ­é…redux-dev-toolä½¿ç”¨
è¯·ç§»æ­¥é˜…è¯»å’Œäº†è§£[concent-plugin-redux-devtool](https://github.com/concentjs/concent-plugin-redux-devtool)ï¼Œå…¨æµç¨‹è¿½æº¯ä½ çš„çŠ¶æ€å˜æ›´è¿‡ç¨‹ã€‚
![redux-dev-tool](https://raw.githubusercontent.com/fantasticsoul/assets/master/img/cc-eco/cc-pic1.png)

## æ­é…loadingæ’ä»¶ä½¿ç”¨
è¯·ç§»æ­¥é˜…è¯»å’Œäº†è§£[concent-plugin-loading](https://github.com/concentjs/concent-plugin-loading)ï¼Œè½»æ¾æ§åˆ¶concentåº”ç”¨é‡Œæ‰€æœ‰reducerå‡½æ•°çš„loadingçŠ¶æ€ã€‚

[concent-plugin-loadingåœ¨çº¿ç¤ºä¾‹](https://stackblitz.com/edit/cc-plugin-loading?file=models%2Fstudent%2Freducer.js)
___
## ğŸ“¦ å¿«é€Ÿå¼€å§‹
ç¡®ä¿ä½ æœ¬åœ°æœºå™¨ä¸Šå®‰è£…æœ‰[nodejs](http://nodejs.cn/download/)ã€‚
### åˆ›å»ºä¸€ä¸ªapp
åœ¨ä½ çš„ç”µè„‘ä¸Šï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ç›®å½•å¹¶è¿›å…¥ï¼Œä½¿ç”¨[create-react-app](https://github.com/facebookincubator/create-react-app) åˆ›å»ºä¸€ä¸ªapp
```sh
$ npm i -g create-react-app
$ create-react-app cc-app
```
### å®‰è£…concent
åˆ›å»ºå¥½appåï¼Œè¿›å…¥ä½ çš„appæ ¹ç›®å½•ï¼Œä½¿ç”¨npmå®‰è£…`concent`
```sh
$ cd cc-app
$ npm i --save concent
```
æˆ–è€…ä½¿ç”¨yarnå®‰è£…
```sh
$ yarn add concent
```
### å°†`App.js`æ–‡ä»¶çš„å†…å®¹å…¨éƒ¨æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç 
> ä½ ä¹Ÿå¯ä»¥[ç‚¹å‡»è¿™é‡Œåœ¨çº¿ç¼–è¾‘](https://codesandbox.io/s/green-tdd-g2mcr).
```javascript
import React, { Component } from 'react';
import { register, run, useConcent } from 'concent';

// è¿è¡Œconcentï¼Œé…ç½®ä¸€ä¸ªåä¸ºcounterçš„æ¨¡å—
run({
  counter:{
    state:{count:1}
  }
})

// å®šä¹‰ä¸€ä¸ªå±äºcounteræ¨¡å—çš„ç±»ç»„ä»¶
@register('counter')
class Counter extends Component{
  render(){
    //æ­¤æ—¶setStateèƒ½å¤Ÿç›´æ¥æäº¤çŠ¶æ€åˆ°storeï¼Œå¹¶å¹¿æ’­åˆ°å…¶ä»–åŒå±äºcounteræ¨¡å—çš„å®ä¾‹
    const add = ()=>this.setState({count:this.state.count+1});
    return (
      <div>
        {this.state.count}
        <button onClick={add}>add</button>
      </div>
    )
  }
}

// å®šä¹‰ä¸€ä¸ªå±äºcounteræ¨¡å—çš„å‡½æ•°ç»„ä»¶
function FnCounter(){
  const ctx = useConcent('counter');
  const add = ()=>ctx.setState({count:ctx.state.count+1});
  return (
    <div>
      {ctx.state.count}
      <button onClick={add}>add</button>
    </div>
  )
}

export default function App() {
  return (
    <div className="App">
      <Counter />
      <FnCounter />
    </div>
  );
}
```

## ğŸ”¨Examples with some advanced features
- è¿è¡Œconcentï¼Œè½½å…¥æ¨¡å—é…ç½®
```javascript
import React, { Component, Fragment } from 'react';
import { register, run } from 'concent';

run({
  counter: {// å®šä¹‰counteræ¨¡å—
    state: {// ã€å¿…éœ€ã€‘ï¼Œå®šä¹‰state
      count: 0,
      products: [],
      type: '',
    },
    reducer: {// ã€å¯é€‰ã€‘å®šä¹‰reducerï¼Œä¹¦å†™ä¿®æ”¹æ¨¡å—çŠ¶æ€é€»è¾‘
      inc(payload=1, moduleState) {
        return { count: moduleState.count + payload };
      },
      dec(payload=1, moduleState) {
        return { count: moduleState.count - payload };
      },
      async inc2ThenDec3(payload, moduleState, actionCtx){
        await actionCtx.dispatch('inc', 2);
        await actionCtx.dispatch('dec', 3);
      }
    },
    computed:{// ã€å¯é€‰ã€‘å®šä¹‰æ¨¡å—computedï¼Œå½“å¯¹åº”çš„stateKeyå‘ç”Ÿå˜åŒ–æ—¶è§¦å‘è®¡ç®—å‡½æ•°ï¼Œç»“æœå°†è¢«ç¼“å­˜
      count(newState, oldState){
        return newState.count * 2;
      }
    },
    watch:{// ã€å¯é€‰ã€‘å®šä¹‰æ¨¡å—watchï¼Œå½“å¯¹åº”çš„stateKeyå‘ç”Ÿå˜åŒ–æ—¶è§¦å‘watchå‡½æ•°ï¼Œé€šå¸¸ç”¨äºè§¦å‘ä¸€äº›å¼‚æ­¥ä»»åŠ¡çš„æ‰§è¡Œ
      count(newState, oldState){
        console.log(`count changed from ${oldState.count} to ${newState.count}`);
      }
    },
    init: async ()=>{// ã€å¯é€‰ã€‘æ¨¡å—çŠ¶æ€çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå½“çŠ¶æ€éœ€è¦å¼‚æ­¥çš„å®šä¹‰ï¼Œä¸”ä¸å…·ä½“æŒ‚è½½çš„ç»„ä»¶æ— å…³æ—¶å®šä¹‰æ­¤é¡¹
      const state = await api.fetchState();
      return state;
    }
  }
})
```
æ›´æ¨èå°†æ¨¡å—å®šä¹‰é€‰é¡¹æ”¾ç½®åˆ°å„ä¸ªæ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨å„è‡ªå¯¼å‡ºäº¤ç»™`run`å‡½æ•°é…ç½®.
```
|____models             # business models
| |____index.js
| |____counter
| | |____index.js
| | |____reducer.js     # change state methods(optional)
| | |____computed.js    # computed methods(optional)
| | |____watch.js       # watch methods(optional)
| | |____init.js        # async state initialization function(optional)
| | |____state.js       # module init state(required)
```
æ­¤æ—¶reduceræ–‡ä»¶é‡Œå‡½æ•°å¯ä»¥ä¸éœ€è¦åŸºäºå­—ç¬¦ä¸²å‘èµ·ç»„åˆå‹è°ƒç”¨äº†
```js
export function inc(payload=1, moduleState) {
  return { count: moduleState.count + payload };
}

export function dec(payload=1, moduleState) {
  return { count: moduleState.count - payload };
}

// ç»„åˆè°ƒç”¨å…¶ä»–çš„reducerå‡½æ•°å®Œæˆä¸šåŠ¡é€»è¾‘
export async function inc2ThenDec3(payload, moduleState, actionCtx){
  await actionCtx.dispatch(inc, 2);
  await actionCtx.dispatch(dec, 3);
}
```
å½“ç„¶reduceræ–‡ä»¶é‡Œï¼Œä½ å¯ä»¥è°ƒç”¨setStateï¼Œæ˜¯ä¸€ä¸ªè¢«promiseè¯çš„å¥æŸ„
```js
export updateLoading(loading){
  return { loading }
}

export async function inc2ThenDec3(payload, moduleState, actionCtx){
  await actionCtx.dispatch(inc, 2);
  //ç­‰æ•ˆäºè°ƒç”¨actionCtx.dispatch(updateLoading, true);
  await actionCtx.setState({loading: true});
  await actionCtx.dispatch(dec, 3);
  //ç­‰æ•ˆäºè°ƒç”¨actionCtx.dispatch(updateLoading, false);
  await actionCtx.setState({loading: false});
  
  //æœ€åè¿™é‡Œä½ å¯ä»¥é€‰æ‹©çš„è¿”å›ä¸€ä¸ªæ–°çš„ç‰‡æ–­çŠ¶æ€ï¼Œä¹Ÿä¼šè§¦å‘è§†å›¾æ›´æ–°
  return { tip: 'you can return some new value in current reducer fn ot not' };
}
```

- å®šä¹‰ setup  
`setup`åªä¼šåœ¨åˆæ¬¡æ¸²æŸ“ä¹‹å‰è¢«æ‰§è¡Œä¸€æ¬¡ï¼ŒåŒæ ·ç”¨äºå®šä¹‰ä¸€äº›å‰¯ä½œç”¨å‡½æ•°ï¼Œæˆ–è€…ä¸€äº›éšåå¯ä»¥åœ¨æ¸²æŸ“å‡½æ•°ä½“å†…é€šè¿‡`ctx.settings`å–åˆ°çš„æ–¹æ³•ï¼Œæ‰€ä»¥å°†ä¸åœ¨äº§ç”Ÿå¤§é‡çš„**ä¸´æ—¶é—­åŒ…å‡½æ•°**ï¼Œä¸”`setup`å¯ä»¥åŒæ—¶ä¼ é€’ç»™ç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ï¼Œæ„å‘³ç€ä½ å¯ä»¥éšæ—¶åœ°åˆ‡æ¢ç»„ä»¶å½¢æ€ï¼Œä¼˜é›…çš„å¤ç”¨ä¸šåŠ¡é€»è¾‘ã€‚
```js
const setup = ctx => {
  console.log('setupå‡½æ•°åªä¼šåœ¨ç»„ä»¶åˆæ¬¡æ¸²æŸ“ä¹‹å‰è¢«æ‰§è¡Œä¸€æ¬¡');
  
  ctx.on('someEvent', (p1, p2)=> console.log('receive ', p1, p2));

  ctx.effect(() => {
    fetchProducts();
  }, ["type", "sex", "addr", "keyword"]);//è¿™é‡Œåªéœ€è¦ä¼ keyåç§°å°±å¯ä»¥äº†
  /** åŸå‡½æ•°ç»„ä»¶å†…å†™æ³•ï¼š
    useEffect(() => {
      fetchProducts(type, sex, addr, keyword);
    }, [type, sex, addr, keyword]);
  */

  ctx.effect(() => {
    return () => {
      // è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°
      // ç­‰ä»·äºcomponentWillUnmout, è¿™é‡Œææ¸…ç†äº‹æƒ…
    };
  }, []);
  /** åŸå‡½æ•°ç»„ä»¶å†…å†™æ³•ï¼š
    useEffect(()=>{
      return ()=>{// è¿”å›ä¸€ä¸ªæ¸…ç†å‡½æ•°
        // ç­‰ä»·äºcomponentWillUnmout, è¿™é‡Œææ¸…ç†äº‹æƒ…
      }
    }, []);//ç¬¬äºŒä½å‚æ•°ä¼ ç©ºæ•°ç»„ï¼Œæ¬¡å‰¯ä½œç”¨åªåœ¨åˆæ¬¡æ¸²æŸ“å®Œæ¯•åæ‰§è¡Œä¸€æ¬¡
  */

  ctx.effectProps(() => {
    // å¯¹propsä¸Šçš„å˜æ›´ä¹¦å†™å‰¯ä½œç”¨ï¼Œæ³¨æ„è¿™é‡Œä¸åŒäºctx.effectï¼Œctx.effectæ˜¯é’ˆå¯¹stateå†™å‰¯ä½œç”¨
    const curTag = ctx.props.tag;
    if (curTag !== ctx.prevProps.tag) ctx.setState({ tag: curTag });
  }, ["tag"]);//è¿™é‡Œåªéœ€è¦ä¼ keyåç§°å°±å¯ä»¥äº†
  /** åŸå‡½æ•°ç»„ä»¶å†…å†™æ³•ï¼š
    useEffect(()=>{
      // é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œæ­¤å‰¯ä½œç”¨è¿˜æ˜¯ä¼šæ‰§è¡Œçš„ï¼Œåœ¨å†…éƒ¨å·§å¦™çš„å†æ¯”è¾ƒä¸€æ¬¡ï¼Œé¿å…ä¸€æ¬¡å¤šä½™çš„uiæ›´æ–°
      // ç­‰ä»·äºç±»ç»„ä»¶é‡ŒgetDerivedStateFromPropsé‡Œçš„é€»è¾‘
      if(tag !== propTag)setTag(tag);
    }, [propTag, tag]);
 */


  // å®šä¹‰å®ä¾‹è®¡ç®—å‡½æ•°ï¼Œå½“countå€¼å˜åŒ–æ—¶ä¼šè§¦å‘å…¶è®¡ç®—ï¼Œç”¨æˆ·å¯éšååœ¨æ¸²æŸ“å‡½æ•°ä½“å†…é€šè¿‡ctx.refComputed.doubleTenè·å¾—è®¡ç®—ç»“æœ
  ctx.computed('doubleTen', (newState, oldState)=>{
    return newState.count * 10;
  }, ['count']);
  // å¤§å¤šæ•°æƒ…å†µä½ åº”è¯¥é¦–å…ˆè€ƒè™‘å®šä¹‰æ¨¡å—è®¡ç®—å‡½æ•°ï¼Œå¦‚æœä½ æƒ³æ‰€æœ‰å®ä¾‹å…±äº«è®¡ç®—é€»è¾‘ä¸”è®¡ç®—å‡½æ•°åªè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå› ä¸ºå¯¹äºå®ä¾‹è®¡ç®—å‡½æ•°æ¥è¯´æ˜¯æ¯ä¸ªå®ä¾‹éƒ½ä¼šè‡ªå·±å•ç‹¬è§¦å‘çš„


  // å¦‚æœç»“æœkeyå’ŒçŠ¶æ€keyå‘½åä¸€æ ·ï¼Œå¯ç®€å†™ä¸ºå¦‚ä¸‹æ ¼å¼
  ctx.computed('count', ({count})=>count*2);

  // å®šä¹‰å®ä¾‹è§‚å¯Ÿå‡½æ•°, å’Œæ¨¡å—è®¡ç®—çš„ç†ç”±ä¸€æ ·ï¼Œä½ åº”è¯¥ä¼˜å…ˆè€ƒè™‘å®šä¹‰æ¨¡å—æ¨¡å—çº§åˆ«çš„è§‚å¯Ÿå‡½æ•°
  ctx.watch('retKey', ()=>{}, ['count']);

  const fetchProducts = () => {
    const { type, sex, addr, keyword } = ctx.state;
    api.fetchProducts({ type, sex, addr, keyword })
      .then(products => ctx.setState({ products }))
      .catch(err => alert(err.message));
  };

  const inc = () => {
    ctx.setState({ count: this.state.count + 1 });
  }
  const dec = () => {
    ctx.setState({ count: this.state.count - 1 });
  }
  // é€šè¿‡dispatchè§¦å‘reducerå‡½æ•°
  const incD = () => {
    ctx.dispatch('inc');// ä¹Ÿå¯ä»¥å†™ä¸º: this.ctx.moduleReducer.inc()
  }
  const decD = () => {
    ctx.dispatch('dec');// ä¹Ÿå¯ä»¥å†™ä¸º: this.ctx.moduleReducer.dec()
  }

  // è¿”å›ç»“æœå°†æ”¶é›†ctx.settingsé‡Œ
  return {
    inc,
    dec,
    incD,
    decD,
    fetchProducts,
    //åŒæ­¥typeå€¼, syncèƒ½å¤Ÿè‡ªåŠ¨æå–eventäº‹ä»¶é‡Œçš„å€¼
    changeType: ctx.sync('type'),
  };
};
```

- åŸºäº`class`ã€`renderProps`, `hook`3ç§æ–¹å¼æ³¨å†Œä¸ºconcentç»„ä»¶
```jsx
@register({module:'counter', setup})
class Counter extends Component {
  constructor(props, context){
    super(props, context);
    this.state = {tag: props.tag};// ç§æœ‰çŠ¶æ€
  }
  render() {
    // æ­¤æ—¶çš„stateç”±ç§æœ‰çŠ¶æ€å’Œæ¨¡å—çŠ¶æ€åˆå¹¶è€Œå¾—
    const { count, products, tag } = this.state;
    // this.state ä¹Ÿå¯ä»¥å†™ä¸º this.ctx.state 
    //const { count, products, tag } = this.ctx.state;

    const {inc, dec, indD, decD, fetchProducts, changeType} = this.ctx.settings;    

    return 'your ui xml...';
  }
}

const PropsCounter = registerDumb({module:'counter', setup})(ctx=>{
  const { count, products, tag } = ctx.state;
  const {inc, dec, indD, decD, fetchProducts, changeType} = ctx.settings;    
  return 'your ui xml...';
});

function HookCounter(){
  const ctx = useConcent({module:'counter', setup});
  const { count, products, tag } = ctx.state;
  const {inc, dec, indD, decD, fetchProducts, changeType} = ctx.settings;    

  return 'your ui xml...';
}
```

## âš–ï¸åœ¨çº¿æ¯”è¾ƒ
* [åŸºäºhookçš„è®¡ç®—å™¨](https://codesandbox.io/s/react-calculator-84f2m) **vs** [åŸºäºconcentçš„è®¡ç®—å™¨](https://codesandbox.io/s/react-calculator-8hvqw)
* [åŸºäºhookçš„æŸ¥è¯¢åˆ—è¡¨](https://codesandbox.io/s/elastic-dhawan-qw7m4) **vs** [åŸºäºconcentçš„æŸ¥è¯¢åˆ—è¡¨](https://codesandbox.io/s/query-react-list-00mkd)& [åŸºäºconcentçš„å…±äº«çŠ¶æ€æŸ¥è¯¢åˆ—è¡¨](https://codesandbox.io/s/query-react-list-shared-state-l3fhb)


## ğŸ’»åœ¨çº¿ç¤ºä¾‹
* [æ¸è¿›å¼çš„å¼€å‘reactåº”ç”¨](https://stackblitz.com/edit/cc-multi-ways-to-wirte-code?file=index.js)
* [æœ‰è¶£çš„counter](https://stackblitz.com/edit/funny-counter)
* [stackblitzç¤ºä¾‹é›†åˆ](https://stackblitz.com/@fantasticsoul)
* [run api demo](https://stackblitz.com/edit/cc-awesome)


## âŒ¨ï¸åœ¨çº¿git
* [concent ant-design-pro](https://github.com/concentjs/antd-pro-concent)


## ğŸ“°å›¾æ–‡æ”¶é›†
* [èŠä¸€èŠçŠ¶æ€ç®¡ç†&Concentè®¾è®¡ç†å¿µ](https://juejin.im/post/5da7cb9cf265da5bbb1e4f8c)
* [åº”æˆ˜Vue3 setupï¼ŒConcentæºæ‰‹Reactå‡ºæ‹›äº†ï¼](https://juejin.im/post/5dd123ec5188253dbe5eeebd)
* [æ·±åº¦æŒ–æ˜Concentçš„effectï¼Œå…¨é¢æå‡useEffectçš„å¼€å‘ä½“éªŒ](https://juejin.im/post/5deb43256fb9a0166316c3e9)
* [concent éªšæ“ä½œä¹‹ç»„ä»¶åˆ›å»º&çŠ¶æ€æ›´æ–°](https://juejin.im/post/5dbe3f18f265da4d3429a439)
* [ä½¿ç”¨concentï¼Œä½“éªŒä¸€æŠŠæ¸è¿›å¼åœ°é‡æ„reactåº”ç”¨ä¹‹æ—…](https://juejin.im/post/5d64f504e51d4561c94b0ff8)
___
## å›¾ç‰‡ä»‹ç»
### ccçŠ¶æ€åˆ†å‘æµç¨‹
![](https://raw.githubusercontent.com/concentjs/concent-site/master/img/cc-core.png)
### ccç»„ä»¶æ¸²æŸ“æµç¨‹
![](https://raw.githubusercontent.com/fantasticsoul/assets/master/img/cc/cc-component-lifecycle.png)
